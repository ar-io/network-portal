{"version":3,"file":"useAllGateways-YBCzRRSm.js","sources":["../../src/hooks/useAllGateways.ts"],"sourcesContent":["import { AoGatewayWithAddress } from '@ar.io/sdk/web';\nimport { useGlobalState } from '@src/store';\nimport { useQuery } from '@tanstack/react-query';\n\ninterface UseAllGatewaysOptions {\n  sortBy?: string;\n  sortOrder?: 'asc' | 'desc';\n}\n\nconst useAllGateways = (options: UseAllGatewaysOptions = {}) => {\n  const arIOReadSDK = useGlobalState((state) => state.arIOReadSDK);\n  const { sortBy = 'totalDelegatedStake', sortOrder = 'desc' } = options;\n\n  return useQuery<AoGatewayWithAddress[]>({\n    queryKey: ['allGateways', arIOReadSDK, sortBy, sortOrder],\n    queryFn: async () => {\n      if (!arIOReadSDK) {\n        throw new Error('arIOReadSDK is not initialized');\n      }\n\n      const allGateways: AoGatewayWithAddress[] = [];\n      let hasNextPage = true;\n      let cursor: string | undefined;\n      const limit = 1000;\n\n      // Fetch all gateways paginated 1k at a time with sorting\n      while (hasNextPage) {\n        const result = await arIOReadSDK.getGateways({\n          cursor,\n          limit,\n          sortBy: sortBy as any,\n          sortOrder,\n        });\n\n        allGateways.push(...result.items);\n        hasNextPage = result.hasMore;\n        cursor = result.nextCursor;\n      }\n\n      // if totalStake sorting, we need to do it client side because totalStake is not a field in the API\n      if (sortBy === 'totalStake') {\n        allGateways.sort((a, b) => {\n          const stakeA = a.totalDelegatedStake + a.operatorStake;\n          const stakeB = b.totalDelegatedStake + b.operatorStake;\n          if (sortOrder === 'asc') {\n            return stakeA - stakeB;\n          } else {\n            return stakeB - stakeA;\n          }\n        });\n      }\n\n      return allGateways;\n    },\n    staleTime: 60 * 60 * 1000,\n    enabled: !!arIOReadSDK,\n    placeholderData: (previousData) => previousData,\n  });\n};\n\nexport default useAllGateways;\n"],"names":["useAllGateways","options","arIOReadSDK","useGlobalState","state","sortBy","sortOrder","useQuery","allGateways","hasNextPage","cursor","limit","result","a","b","stakeA","stakeB","previousData"],"mappings":"sWASA,MAAAA,EAAA,CAAAC,EAAA,CAAA,IAAA,CACA,MAAAC,EAAAC,EAAAC,GAAAA,EAAA,WAAA,EACA,CAAA,OAAAC,EAAA,sBAAA,UAAAC,EAAA,MAAA,EAAAL,EAEA,OAAAM,EAAA,CAAA,SAAA,CAAA,cAAAL,EAAAG,EAAAC,CAAA,EACA,QAAA,SAAA,CAEA,GAAA,CAAAJ,EACA,MAAA,IAAA,MAAA,gCAAA,EAGA,MAAAM,EAAA,CAAA,EACA,IAAAC,EAAA,GACAC,EACA,MAAAC,EAAA,IAGA,KAAAF,GAAA,CACA,MAAAG,EAAA,MAAAV,EAAA,YAAA,CAAA,OAAAQ,EACA,MAAAC,EACA,OAAAN,EACA,UAAAC,CACA,CAAA,EAGAE,EAAA,KAAA,GAAAI,EAAA,KAAA,EACAH,EAAAG,EAAA,QACAF,EAAAE,EAAA,UAAA,CAIA,OAAAP,IAAA,cACAG,EAAA,KAAA,CAAAK,EAAAC,IAAA,CACA,MAAAC,EAAAF,EAAA,oBAAAA,EAAA,cACAG,EAAAF,EAAA,oBAAAA,EAAA,cACA,OAAAR,IAAA,MACAS,EAAAC,EAEAA,EAAAD,CACA,CAAA,EAIAP,CAAA,EACA,UAAA,GAAA,GAAA,IACA,QAAA,CAAA,CAAAN,EACA,gBAAAe,GAAAA,CACA,CAAA,CAEA"}