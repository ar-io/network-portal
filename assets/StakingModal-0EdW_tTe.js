import{r as l,U as Je,V as G,X as pe,Y as Ce,Z as Oe,_ as he,$ as ae,a0 as ge,a1 as Te,a2 as Ae,a3 as Ie,a4 as De,a5 as Me,a6 as Xe,a7 as Ze,a8 as et,a9 as tt,aa as U,ab as Re,ac as ue,ad as ke,ae as Ee,af as at,e as $e,o as Q,R as L,j as e,w as le,a as F,B as H,p as V,d as D,q as _,s as W,x as ne,y as re,z as ie,W as z,M as se,D as oe,v as Fe,Q as st,g as lt,n as Le,b as ve,h as nt,T as fe,E as Pe,t as _e,I as We,ag as rt,m as it}from"./index-DT_KQEYq.js";import{K as qe,l as ot,T as ct,j as dt,u as ut,I as xt,Q as ft,p as mt,v as Ke,E as Ye,d as pt}from"./validation-DxHxJWOA.js";import{L as y,u as Be}from"./useDelegateStakes-D2fz13wy.js";import{T as ht,c as gt,u as vt}from"./index-tbIpH_Tt.js";import{S as yt}from"./search-CFp1EMlw.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new Error().stack;s&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[s]="8c42ff20-e1b1-401d-b629-c06bbc8eebfa",t._sentryDebugIdIdentifier="sentry-dbid-8c42ff20-e1b1-401d-b629-c06bbc8eebfa")}catch{}})();var B=function(){return(B=Object.assign||function(t){for(var s,i=1,a=arguments.length;i<a;i++)for(var n in s=arguments[i])Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n]);return t}).apply(this,arguments)},wt=function(t,s){var i={};for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&s.indexOf(n)<0&&(i[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)s.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(i[n[a]]=t[n[a]]);return i},te=function(t){return"Typesetting failed: ".concat(t.message!==void 0?t.message:t.toString())},Ge=function(t){function s(){var g;w==="every"&&C&&p==="post"&&x.current!==null&&(x.current.style.visibility=(g=(g=r.style)==null?void 0:g.visibility)!=null?g:"visible"),k.current||(w==="first"&&x.current!==null&&(x.current.style.visibility="visible"),n&&n(),k.current=!0),d&&d(),N.current=!1}var a=t.inline,i=a!==void 0&&a,a=t.hideUntilTypeset,n=t.onInitTypeset,d=t.onTypeset,u=t.text,o=t.dynamic,c=t.typesettingOptions,f=t.renderMode,h=t.children,r=wt(t,["inline","hideUntilTypeset","onInitTypeset","onTypeset","text","dynamic","typesettingOptions","renderMode","children"]),b=l.useRef(""),x=l.useRef(null),v=l.useContext(Je),w=a??(v==null?void 0:v.hideUntilTypeset),p=f??(v==null?void 0:v.renderMode),S=c??(v==null?void 0:v.typesettingOptions),C=o!==!1&&(o||!1),k=l.useRef(!1),N=l.useRef(!1);return!N.current&&x.current!==null&&C&&w==="every"&&p==="post"&&(x.current.style.visibility="hidden"),(typeof window<"u"?l.useLayoutEffect:l.useEffect)(function(){if((C||!k.current)&&x.current!==null){if(!v)throw Error("MathJax was not loaded, did you use the MathJax component outside of a MathJaxContext?");if(p==="pre"){if(!(typeof(g=u)=="string"&&0<g.length))throw Error(`Render mode 'pre' requires text prop to be set and non-empty, which was currently "`.concat(u,'"'));if(!c||!c.fn)throw Error("Render mode 'pre' requires 'typesettingOptions' prop with 'fn' property to be set on MathJax element or in the MathJaxContext");if(v.version===2)throw Error("Render mode 'pre' only available with MathJax 3, and version 2 is currently in use")}p!=="post"&&u===b.current||N.current||(N.current=!0,v.version===3?v.promise.then(function(j){var R;p==="pre"?(R=function(m){b.current=u,j.startup.document.clear(),j.startup.document.updateDocument(),x.current!==null&&(x.current.innerHTML=m.outerHTML),s()},c.fn.endsWith("Promise")?j.startup.promise.then(function(){return j[S.fn](u,B(B({},(S==null?void 0:S.options)||{}),{display:!i}))}).then(R).catch(function(m){throw s(),Error(te(m))}):j.startup.promise.then(function(){var m=j[S.fn](u,B(B({},(S==null?void 0:S.options)||{}),{display:!i}));R(m)}).catch(function(m){throw s(),Error(te(m))})):j.startup.promise.then(function(){return j.typesetClear([x.current]),j.typesetPromise([x.current])}).then(s).catch(function(m){throw s(),Error(te(m))})}).catch(function(j){throw s(),Error(te(j))}):v.promise.then(function(j){j.Hub.Queue(["Typeset",j.Hub,x.current]),j.Hub.Queue(s)}).catch(function(j){throw s(),Error(te(j))}))}var g}),G.createElement("span",B({},r,{style:B(B({display:i?"inline":"block"},r.style),{visibility:w?"hidden":(t=r.style)==null?void 0:t.visibility}),ref:x}),h)};const Qe=t=>l.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},l.createElement("g",{id:"Frame",clipPath:"url(#clip0_2391_9440)"},l.createElement("path",{id:"Vector",d:"M8.00016 14.6663C11.6821 14.6663 14.6668 11.6816 14.6668 7.99967C14.6668 4.31778 11.6821 1.33301 8.00016 1.33301C4.31826 1.33301 1.3335 4.31778 1.3335 7.99967C1.3335 11.6816 4.31826 14.6663 8.00016 14.6663Z",stroke:"#7F7F87",strokeLinecap:"round",strokeLinejoin:"round"}),l.createElement("path",{id:"Vector_2",d:"M8 10.6667V8",stroke:"#7F7F87",strokeLinecap:"round",strokeLinejoin:"round"}),l.createElement("path",{id:"Vector_3",d:"M8 5.33301H8.00667",stroke:"#7F7F87",strokeLinecap:"round",strokeLinejoin:"round"})),l.createElement("defs",null,l.createElement("clipPath",{id:"clip0_2391_9440"},l.createElement("rect",{width:16,height:16,fill:"white"})))),bt=t=>l.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.4781 2.39428C10.9366 2.1271 11.4578 1.98633 11.9885 1.98633C12.5191 1.98633 13.0403 2.1271 13.4989 2.39428C13.9568 2.66112 14.3359 3.04451 14.5975 3.50542C14.5978 3.50601 14.5981 3.50659 14.5985 3.50717L22.5945 17.5002C22.5948 17.5008 22.5951 17.5013 22.5955 17.5019C22.858 17.9573 22.9963 18.4738 22.9964 18.9995C22.9965 19.5258 22.8582 20.0429 22.5953 20.4989C22.3323 20.9549 21.954 21.3336 21.4984 21.5971C21.0428 21.8607 20.5258 21.9997 19.9995 22.0002H4.00257C3.47536 22.0041 2.95641 21.869 2.49801 21.6084C2.03819 21.3471 1.65564 20.9688 1.38913 20.5119C1.12263 20.0551 0.981647 19.5359 0.980476 19.0069C0.979307 18.4789 1.11755 17.9598 1.38123 17.5023C1.38164 17.5016 1.38205 17.5009 1.38246 17.5002L9.37846 3.50717C9.3788 3.50659 9.37913 3.50601 9.37946 3.50542C9.64108 3.04451 10.0201 2.66112 10.4781 2.39428ZM11.9885 3.98633C11.8116 3.98633 11.6378 4.03325 11.485 4.12231C11.3322 4.21137 11.2057 4.33938 11.1185 4.49328L11.1167 4.49636L3.11448 18.5003C3.02632 18.653 2.98008 18.8262 2.98047 19.0025C2.98086 19.1788 3.02786 19.3519 3.11669 19.5042C3.20552 19.6565 3.33304 19.7826 3.48631 19.8697C3.63959 19.9568 3.81317 20.0019 3.98947 20.0003L3.99846 20.0002L19.9974 20.0002C20.1729 20 20.3452 19.9537 20.4971 19.8659C20.649 19.778 20.775 19.6518 20.8627 19.4998C20.9503 19.3478 20.9965 19.1754 20.9964 19C20.9964 18.8245 20.9502 18.6522 20.8624 18.5002L20.8602 18.4964L12.8602 4.49636L12.8585 4.49328C12.7712 4.33938 12.6448 4.21137 12.4919 4.12231C12.3391 4.03325 12.1654 3.98633 11.9885 3.98633ZM11.9985 8.00022C12.5507 8.00022 12.9985 8.44794 12.9985 9.00022V13.0002C12.9985 13.5525 12.5507 14.0002 11.9985 14.0002C11.4462 14.0002 10.9985 13.5525 10.9985 13.0002V9.00022C10.9985 8.44794 11.4462 8.00022 11.9985 8.00022ZM10.9985 17.0002C10.9985 16.4479 11.4462 16.0002 11.9985 16.0002H12.0085C12.5608 16.0002 13.0085 16.4479 13.0085 17.0002C13.0085 17.5525 12.5608 18.0002 12.0085 18.0002H11.9985C11.4462 18.0002 10.9985 17.5525 10.9985 17.0002Z",fill:"url(#paint0_linear_3023_6650)"}),l.createElement("defs",null,l.createElement("linearGradient",{id:"paint0_linear_3023_6650",x1:.980469,y1:22.0003,x2:23.87,y2:20.9457,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#FFB4B4"}),l.createElement("stop",{offset:1,stopColor:"#FF6C6C"}))));function jt(t,s){return t!==null&&s!==null&&typeof t=="object"&&typeof s=="object"&&"id"in t&&"id"in s?t.id===s.id:t===s}function St(t=jt){return l.useCallback((s,i)=>{if(typeof t=="string"){let a=t;return(s==null?void 0:s[a])===(i==null?void 0:i[a])}return t(s,i)},[t])}var Rt=(t=>(t[t.RegisterOption=0]="RegisterOption",t[t.UnregisterOption=1]="UnregisterOption",t))(Rt||{});let kt={0(t,s){let i=[...t.options,{id:s.id,element:s.element,propsRef:s.propsRef}];return{...t,options:at(i,a=>a.element.current)}},1(t,s){let i=t.options.slice(),a=t.options.findIndex(n=>n.id===s.id);return a===-1?t:(i.splice(a,1),{...t,options:i})}},ye=l.createContext(null);ye.displayName="RadioGroupDataContext";function we(t){let s=l.useContext(ye);if(s===null){let i=new Error(`<${t} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,we),i}return s}let be=l.createContext(null);be.displayName="RadioGroupActionsContext";function je(t){let s=l.useContext(be);if(s===null){let i=new Error(`<${t} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,je),i}return s}function Nt(t,s){return et(s.type,kt,t,s)}let Ct="div";function Ot(t,s){let i=l.useId(),a=Ce(),{id:n=`headlessui-radiogroup-${i}`,value:d,form:u,name:o,onChange:c,by:f,disabled:h=a||!1,defaultValue:r,...b}=t,x=St(f),[v,w]=l.useReducer(Nt,{options:[]}),p=v.options,[S,C]=qe(),[k,N]=Oe(),g=l.useRef(null),j=he(g,s),R=ot(r),[m,O]=ct(d,c,R),E=l.useMemo(()=>p.find(I=>!I.propsRef.current.disabled),[p]),A=l.useMemo(()=>p.some(I=>x(I.propsRef.current.value,m)),[p,m]),T=ae(I=>{var Z;if(h||x(I,m))return!1;let K=(Z=p.find(de=>x(de.propsRef.current.value,I)))==null?void 0:Z.propsRef.current;return K!=null&&K.disabled?!1:(O==null||O(I),!0)}),q=ae(I=>{let Z=g.current;if(!Z)return;let K=tt(Z),de=p.filter(P=>P.propsRef.current.disabled===!1).map(P=>P.element.current);switch(I.key){case U.Enter:mt(I.currentTarget);break;case U.ArrowLeft:case U.ArrowUp:if(I.preventDefault(),I.stopPropagation(),Re(de,ue.Previous|ue.WrapAround)===ke.Success){let P=p.find(ee=>ee.element.current===(K==null?void 0:K.activeElement));P&&T(P.propsRef.current.value)}break;case U.ArrowRight:case U.ArrowDown:if(I.preventDefault(),I.stopPropagation(),Re(de,ue.Next|ue.WrapAround)===ke.Success){let P=p.find(ee=>ee.element.current===(K==null?void 0:K.activeElement));P&&T(P.propsRef.current.value)}break;case U.Space:{I.preventDefault(),I.stopPropagation();let P=p.find(ee=>ee.element.current===(K==null?void 0:K.activeElement));P&&T(P.propsRef.current.value)}break}}),J=ae(I=>(w({type:0,...I}),()=>w({type:1,id:I.id}))),me=l.useMemo(()=>({value:m,firstOption:E,containsCheckedOption:A,disabled:h,compare:x,...v}),[m,E,A,h,x,v]),X=l.useMemo(()=>({registerOption:J,change:T}),[J,T]),M={ref:j,id:n,role:"radiogroup","aria-labelledby":S,"aria-describedby":k,onKeyDown:q},$=l.useMemo(()=>({value:m}),[m]),Y=l.useCallback(()=>{if(R!==void 0)return T(R)},[T,R]),ce=ge();return G.createElement(N,{name:"RadioGroup.Description"},G.createElement(C,{name:"RadioGroup.Label"},G.createElement(be.Provider,{value:X},G.createElement(ye.Provider,{value:me},o!=null&&G.createElement(dt,{disabled:h,data:{[o]:m||"on"},overrides:{type:"radio",checked:m!=null},form:u,onReset:Y}),ce({ourProps:M,theirProps:b,slot:$,defaultTag:Ct,name:"RadioGroup"})))))}let Tt="div";function At(t,s){var i;let a=we("RadioGroup.Option"),n=je("RadioGroup.Option"),d=l.useId(),{id:u=`headlessui-radiogroup-option-${d}`,value:o,disabled:c=a.disabled||!1,autoFocus:f=!1,...h}=t,r=l.useRef(null),b=he(r,s),[x,v]=qe(),[w,p]=Oe(),S=Te({value:o,disabled:c});Ae(()=>n.registerOption({id:u,element:r,propsRef:S}),[u,n,r,S]);let C=ae(T=>{var q;if(Ee(T.currentTarget))return T.preventDefault();n.change(o)&&((q=r.current)==null||q.focus())}),k=((i=a.firstOption)==null?void 0:i.id)===u,{isFocusVisible:N,focusProps:g}=Ie({autoFocus:f}),{isHovered:j,hoverProps:R}=De({isDisabled:c}),m=a.compare(a.value,o),O=Me({ref:b,id:u,role:"radio","aria-checked":m?"true":"false","aria-labelledby":x,"aria-describedby":w,"aria-disabled":c?!0:void 0,tabIndex:c?-1:m||!a.containsCheckedOption&&k?0:-1,onClick:c?void 0:C,autoFocus:f},g,R),E=l.useMemo(()=>({checked:m,disabled:c,active:N,hover:j,focus:N,autofocus:f}),[m,c,j,N,f]),A=ge();return G.createElement(p,{name:"RadioGroup.Description"},G.createElement(v,{name:"RadioGroup.Label"},A({ourProps:O,theirProps:h,slot:E,defaultTag:Tt,name:"RadioGroup.Option"})))}let It="span";function Dt(t,s){var i;let a=we("Radio"),n=je("Radio"),d=l.useId(),u=ut(),o=Ce(),{id:c=u||`headlessui-radio-${d}`,value:f,disabled:h=a.disabled||o||!1,autoFocus:r=!1,...b}=t,x=l.useRef(null),v=he(x,s),w=xt(),p=Xe(),S=Te({value:f,disabled:h});Ae(()=>n.registerOption({id:c,element:x,propsRef:S}),[c,n,x,S]);let C=ae(A=>{var T;if(Ee(A.currentTarget))return A.preventDefault();n.change(f)&&((T=x.current)==null||T.focus())}),{isFocusVisible:k,focusProps:N}=Ie({autoFocus:r}),{isHovered:g,hoverProps:j}=De({isDisabled:h}),R=((i=a.firstOption)==null?void 0:i.id)===c,m=a.compare(a.value,f),O=Me({ref:v,id:c,role:"radio","aria-checked":m?"true":"false","aria-labelledby":w,"aria-describedby":p,"aria-disabled":h?!0:void 0,tabIndex:h?-1:m||!a.containsCheckedOption&&R?0:-1,autoFocus:r,onClick:h?void 0:C},N,j),E=l.useMemo(()=>({checked:m,disabled:h,hover:g,focus:k,autofocus:r}),[m,h,g,k,r]);return ge()({ourProps:O,theirProps:b,slot:E,defaultTag:It,name:"Radio"})}let Mt=pe(Ot),Et=pe(At),$t=pe(Dt),Ft=ft,Lt=Ze,Xt=Object.assign(Mt,{Option:Et,Radio:$t,Label:Ft,Description:Lt});/**
 * @license lucide-react v0.461.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=$e("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.461.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=$e("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Se=365,Ve=5e-4,He=.9,ta=(t,s,i,a)=>{const d=t.valueOf()*Ve*He/s,u=i.settings.delegateRewardShareRatio/100,o=new Q(d*(1-u)),c=a.valueOf()>0?o.valueOf()/a.valueOf():-1,f=c*Se;return{operatorStake:a,rewardsSharedPerEpoch:o,EEY:c,EAY:f}},ze=(t,s,i)=>{const n=t.valueOf()*Ve*He/s,d=i.settings.delegateRewardShareRatio/100,u=new L(i.totalDelegatedStake).toARIO(),o=new Q(n*d),c=u.valueOf()>0?o.valueOf()/u.valueOf():-1,f=c*Se;return{totalDelegatedStake:u,rewardsSharedPerEpoch:o,EEY:c,EAY:f}},Pt=(t,s,i=!1)=>{const a=i?-1:1,n=s.valueOf()*a,d=n/(t.totalDelegatedStake.valueOf()+n),o=t.rewardsSharedPerEpoch.valueOf()*d/n,c=o*Se;return{EEY:o,EAY:c}},_t=()=>e.jsx("div",{children:e.jsxs("div",{className:"flex gap-3 rounded bg-containerL3 p-4",children:[e.jsx(bt,{width:40,height:20}),e.jsx("div",{className:"grow text-[0.8125rem] text-high",children:"90 days is the standard withdrawal period. During this time your tokens will be locked and will not be accruing rewards."})]})}),Wt=({gateway:t,amountToStake:s,onSuccess:i,onClose:a,walletAddress:n,ticker:d})=>{const u=le(),o=F(w=>w.arIOWriteableSDK),[c,f]=l.useState(),[h,r]=l.useState(!1),[b,x]=l.useState(!1),v=async()=>{if(o){r(!0);try{if(t.gatewayAddress===n.toString()){const{id:w}=await o.increaseOperatorStake({increaseQty:new Q(s).toMARIO()},z);f(w),se.info(`Increase Operator Stake txID: ${w}`)}else{const{id:w}=await o.delegateStake({target:t.gatewayAddress,stakeQty:new Q(s).toMARIO()},z);f(w),se.info(`Increase Delegate Stake txID: ${w}`)}u.invalidateQueries({queryKey:["gateway",n.toString()],refetchType:"all"}),u.invalidateQueries({queryKey:["gateways"],refetchType:"all"}),u.invalidateQueries({queryKey:["balances"],refetchType:"all"}),u.invalidateQueries({queryKey:["delegateStakes"],refetchType:"all"}),u.invalidateQueries({queryKey:["gatewayVaults"],refetchType:"all"}),x(!0)}catch(w){oe(`${w}`)}finally{r(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(H,{onClose:a,useDefaultPadding:!1,showCloseButton:!1,children:e.jsxs("div",{className:"w-[calc(100vw-2rem)] lg:w-[28.5rem]",children:[e.jsx("div",{className:"text-gradient rounded-t-xl border-b border-b-stroke-low bg-containerL3 p-4",children:"Review"}),e.jsxs("div",{className:"flex flex-col gap-2 p-8",children:[e.jsx(y,{label:"Gateway Owner:",value:V(t.gatewayAddress)}),e.jsx(y,{label:"Label:",value:t?t.settings.label:"-"}),e.jsx(y,{label:"Domain:",isLink:!0,value:t?t.settings.fqdn:"-"}),e.jsx(y,{label:"Amount:",value:`${D(s)} ${d}`})]}),e.jsx("div",{className:"px-8 pb-6 text-left",children:e.jsx(_t,{})}),e.jsxs("div",{className:"flex size-full flex-col bg-containerL0 px-8 pb-2 pt-6",children:[e.jsx(_,{className:"h-[3.25rem] w-full",onClick:v,buttonType:W.PRIMARY,title:`Stake ${d}`,text:`Stake ${d}`}),e.jsx("div",{children:e.jsx("button",{className:"h-[3.25rem] p-4 text-sm",onClick:a,children:"Back"})})]})]})}),h&&e.jsx(ne,{onClose:()=>r(!1),message:"Sign the following data with your wallet to proceed."}),b&&e.jsx(re,{onClose:()=>{x(!1),a(),i()},title:"Congratulations",bodyText:e.jsxs("div",{className:"mb-8 text-sm text-mid",children:[e.jsx("div",{children:"You have successfully updated your stake."}),e.jsxs("div",{className:"my-2 flex flex-col justify-center gap-2",children:[e.jsx("div",{children:"Transaction ID:"}),e.jsxs("button",{className:"flex items-center justify-center break-all",title:"View transaction on ao.link",onClick:async()=>{window.open(`https://ao.link/#/message/${c}`,"_blank")},children:[c,e.jsx(ie,{className:"ml-1 size-3"})]})]})]})})]})},aa=({gateway:t,amountToWithdraw:s,withdrawalType:i,onSuccess:a,onClose:n,walletAddress:d,ticker:u,withdrawalFee:o,returningAmount:c})=>{const f=le(),h=F(R=>R.arIOWriteableSDK),[r,b]=l.useState(),[x,v]=l.useState(!1),[w,p]=l.useState(!1),[S,C]=l.useState(""),[k,N]=l.useState(""),g=k==="WITHDRAW";l.useEffect(()=>{C(i==="expedited"?"Instant":Fe(st(new Date).add(30,"day").toDate()))},[i]);const j=async()=>{if(h){v(!0);try{const R=i==="expedited";if(t.gatewayAddress===d.toString()){const{id:m}=await h.decreaseOperatorStake({decreaseQty:new Q(s).toMARIO(),instant:R},z);b(m),se.info(`Decrease Operator Stake txID: ${m}`)}else{const{id:m}=await h.decreaseDelegateStake({target:t.gatewayAddress,decreaseQty:new Q(s).toMARIO(),instant:R},z);b(m),se.info(`Decrease Delegate Stake txID: ${m}`)}f.invalidateQueries({queryKey:["gateway",d.toString()],refetchType:"all"}),f.invalidateQueries({queryKey:["gateways"],refetchType:"all"}),f.invalidateQueries({queryKey:["balances"],refetchType:"all"}),f.invalidateQueries({queryKey:["delegateStakes"],refetchType:"all"}),f.invalidateQueries({queryKey:["gatewayVaults"],refetchType:"all"}),p(!0)}catch(R){oe(`${R}`)}finally{v(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(H,{onClose:n,useDefaultPadding:!1,showCloseButton:!1,children:e.jsxs("div",{className:"w-[calc(100vw-2rem)] lg:w-[28.5rem]",children:[e.jsx("div",{className:"text-gradient rounded-t-xl border-b border-b-stroke-low bg-containerL3 p-4",children:"Review"}),e.jsxs("div",{className:"flex flex-col gap-2 p-8",children:[e.jsx(y,{label:"Gateway Owner:",value:V(t.gatewayAddress)}),e.jsx(y,{label:"Label:",value:t?t.settings.label:"-"}),e.jsx(y,{label:"Domain:",isLink:!0,value:t?t.settings.fqdn:"-"}),e.jsx(y,{label:"Amount:",value:`${D(s)} ${u}`}),e.jsx(y,{label:"Date of Return:",value:S})]}),e.jsxs("div",{className:"flex flex-col gap-2 px-8 pb-8",children:[e.jsx(y,{label:"Stake Withdrawing:",value:`${D(s)} ${u}`}),i==="expedited"&&e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"first:text-mid last:text-mid",label:"Fee:",value:`${isNaN(o)?"-":+o.toFixed(4)} ${u}`}),e.jsx(y,{className:"first:text-mid last:text-mid",label:"Returning Amount:",value:`${c} ${u}`})]})]}),e.jsxs("div",{className:"flex size-full flex-col bg-containerL0 px-8 pb-2 pt-6",children:[e.jsxs("div",{className:"mb-6 flex flex-col items-center gap-2 text-sm text-mid",children:[e.jsx("div",{children:'Please type "WITHDRAW" in the text box to proceed.'}),e.jsx("input",{type:"text",onChange:R=>N(R.target.value),className:"h-7 w-full rounded-md border border-grey-700 bg-grey-1000 p-4 text-sm text-mid outline-none placeholder:text-grey-400 focus:text-high",value:k})]}),e.jsx("div",{className:g?void 0:"pointer-events-none opacity-30",children:e.jsx(_,{className:"h-[3.25rem] w-full",onClick:j,buttonType:W.PRIMARY,title:`Withdraw ${u}`,text:`Withdraw ${u}`})}),e.jsx("div",{children:e.jsx("button",{className:"h-[3.25rem] p-4 text-sm",onClick:n,children:"Back"})})]})]})}),x&&e.jsx(ne,{onClose:()=>v(!1),message:"Sign the following data with your wallet to proceed."}),w&&e.jsx(re,{onClose:()=>{p(!1),n(),a()},title:"Congratulations",bodyText:e.jsxs("div",{className:"mb-8 text-sm text-mid",children:[e.jsx("div",{children:"You have successfully updated your stake."}),e.jsxs("div",{className:"my-2 flex flex-col justify-center gap-2",children:[e.jsx("div",{children:"Transaction ID:"}),e.jsxs("button",{className:"flex items-center justify-center break-all",title:"View transaction on ao.link",onClick:async()=>{window.open(`https://ao.link/#/message/${r}`,"_blank")},children:[r,e.jsx(ie,{className:"ml-1 size-3"})]})]})]})})]})},Ue=t=>{const s=F(a=>a.arIOReadSDK);return lt({queryKey:["redelegationFee",t,s],queryFn:async()=>{if(!s)throw new Error("arIOReadSDK not initialized");if(!t)throw new Error("walletAddress not initialized");return await s.getRedelegationFee({address:t})},enabled:!!s&&!!t})},xe=gt(),qt=({gateways:t,onClose:s,onGatewaySelected:i})=>{const a=F(r=>r.ticker),[n,d]=l.useState([]),{data:u}=Le(),{data:o}=ve(),[c,f]=l.useState();l.useEffect(()=>{if(u&&o&&t){const r=t.map(b=>({gateway:b,label:b.settings.label,rewardShareRatio:b.settings.delegateRewardShareRatio,totalStake:new L(b.totalDelegatedStake).toARIO().valueOf(),eay:ze(new L(u).toARIO(),Object.values(o).filter(x=>x.status=="joined").length,b).EAY}));if(c&&c.length>0){const b=r.filter(x=>x.label.toLowerCase().includes(c.toLowerCase())||x.gateway.settings.fqdn.toLowerCase().includes(c.toLowerCase())||x.gateway.gatewayAddress.toLowerCase().includes(c.toLowerCase()));d(b)}else d(r)}},[o,t,u,c]);const h=[xe.accessor("label",{id:"label",header:"Gateway",sortDescFirst:!0,cell:({row:r})=>e.jsxs("div",{className:"flex flex-col text-left",children:[e.jsx("div",{className:"text-sm text-high",children:r.original.label}),e.jsx("div",{className:"text-xs",children:V(r.original.gateway.gatewayAddress)})]})}),xe.accessor("rewardShareRatio",{id:"rewardShareRatioe",header:"Reward Share",sortDescFirst:!0,cell:({row:r})=>nt(r.original.rewardShareRatio/100)}),xe.accessor("totalStake",{id:"totalStake",header:"Total Stake",sortDescFirst:!0,cell:({row:r})=>`${D(r.original.totalStake)} ${a}`}),xe.accessor("eay",{id:"eay",header:()=>e.jsxs("div",{className:"flex gap-1",children:["EAY",e.jsx(fe,{message:e.jsxs("div",{children:[e.jsx("p",{children:Pe}),e.jsx(Ge,{className:"mt-4",children:_e})]}),children:e.jsx(We,{className:"h-4"})})]}),sortDescFirst:!0,cell:({row:r})=>e.jsx("div",{children:r.original.eay<0?"N/A":`${D(r.original.eay*100)}%`})})];return e.jsx(H,{onClose:s,showCloseButton:!1,closeOnClickOutside:!0,children:e.jsxs("div",{className:"w-[calc(100vw-2rem)] overflow-hidden rounded-xl border border-grey-500 text-left lg:w-[48rem]",children:[e.jsxs("div",{className:"flex items-center rounded-t-xl border border-grey-500 px-6 py-2",children:[e.jsx(yt,{className:"size-4 text-mid"}),e.jsx("input",{type:"text",placeholder:"Enter label, domain, or address",className:"grow bg-transparent px-3 py-2 text-sm text-high placeholder:text-low focus:outline-none",value:c??"",onChange:r=>f(r.target.value)})]}),e.jsx(ht,{columns:h,data:n,onRowClick:r=>{i(r.gateway),s()},defaultSortingState:{id:"label",desc:!1},isLoading:!1,noDataFoundText:"No gateways found.",shortTable:!0})]})})},Kt=({selectedGateway:t,setSelectedGateway:s,gateways:i})=>{const[a,n]=l.useState(!1);return e.jsxs("div",{className:"flex items-center rounded border border-grey-500 p-2 pl-6 text-left text-sm text-mid",children:[e.jsx("div",{className:"grow",children:i?t?V(t.gatewayAddress):"":"Loading Gateways..."}),e.jsx("div",{className:i?void 0:"pointer-events-none opacity-30",children:e.jsx(_,{buttonType:W.SECONDARY,className:"max-h-7 text-mid",active:!0,title:"Choose Gateway",text:"Choose Gateway",onClick:()=>n(!0)})}),a&&i&&e.jsx(qt,{gateways:i,onClose:()=>n(!1),onGatewaySelected:s})]})},Yt=({sourceGateway:t,targetGateway:s,amountToRedelegate:i,vaultId:a,fee:n,newTotalStake:d,onSuccess:u,onClose:o,walletAddress:c,ticker:f})=>{const h=le(),r=F(O=>O.arIOWriteableSDK),[b,x]=l.useState(),[v,w]=l.useState(!1),[p,S]=l.useState(!1),[C,k]=l.useState(""),{data:N}=Ue(),g=n>0,j=i.valueOf()-n,R=v||g&&C!=="CONFIRM",m=async()=>{if(!R&&r){w(!0);try{const{id:O}=await r.redelegateStake({source:t.gatewayAddress,target:s.gatewayAddress,stakeQty:i.toMARIO(),vaultId:a},z);x(O),se.info(`Redelegate Stake txID: ${O}`),h.invalidateQueries({queryKey:["gateway",c.toString()],refetchType:"all"}),h.invalidateQueries({queryKey:["gateways"],refetchType:"all"}),h.invalidateQueries({queryKey:["balances"],refetchType:"all"}),h.invalidateQueries({queryKey:["delegateStakes"],refetchType:"all"}),h.invalidateQueries({queryKey:["gatewayVaults"],refetchType:"all"}),S(!0)}catch(O){oe(`${O}`)}finally{w(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(H,{onClose:o,useDefaultPadding:!1,showCloseButton:!1,children:e.jsxs("div",{className:"w-[calc(100vw-2rem)] lg:w-[28.5rem]",children:[e.jsx("div",{className:"text-gradient rounded-t-xl border-b border-b-stroke-low bg-containerL3 p-4",children:"Review"}),e.jsxs("div",{className:"flex flex-col gap-2 p-8",children:[e.jsx(y,{label:"Source Gateway Owner:",value:V(t.gatewayAddress)}),e.jsx(y,{label:"Label:",value:t.settings.label}),e.jsx(y,{label:"Domain:",isLink:!0,value:t.settings.fqdn}),e.jsx("div",{className:"h-6"}),e.jsx(y,{label:"Target Gateway Owner:",value:V(s.gatewayAddress)}),e.jsx(y,{label:"Label:",value:s.settings.label}),e.jsx(y,{label:"Domain:",isLink:!0,value:s.settings.fqdn}),e.jsx("div",{className:"h-6"}),e.jsx(y,{label:"Amount:",value:`${D(i.valueOf())} ${f}`}),n>0&&e.jsx(y,{label:"Fee:",value:`${n>0&&n} ${N?`(-${N.redelegationFeeRate}%)`:""} ${f}`}),e.jsx(y,{label:"Total Redelegated Stake:",value:`${D(j)} ${f}`}),e.jsx(y,{label:"New Total Stake:",value:`${D(d)} ${f}`})]}),e.jsx("div",{className:"px-8 pb-6 text-left",children:e.jsx("div",{children:e.jsx("div",{className:"flex gap-3 rounded bg-containerL3 p-4",children:e.jsx("div",{className:"grow text-[0.8125rem] text-mid",children:"Users get one free redelegation every 7 days. Fees then increase incrementally (10%, 20%, ... up to 60%) and stay at 60% until resetting after 7 days of no action."})})})}),e.jsxs("div",{className:"flex size-full flex-col bg-containerL0 px-8 pb-2 pt-6",children:[g&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{htmlFor:"confirmation-input",className:"mb-2 block text-sm font-medium text-mid",children:["Please type CONFIRM to acknowledge there will be a fee of"," ",n," ",f," for redelegating."]}),e.jsx("input",{type:"text",id:"confirmation-input",value:C,onChange:O=>k(O.target.value),className:"h-7 w-full rounded-md border border-grey-700 bg-grey-1000 p-4 text-sm text-mid outline-none placeholder:text-grey-400 focus:text-high"})]}),e.jsx("div",{className:v||g&&C!=="CONFIRM"?"pointer-events-none opacity-30":"",children:e.jsx(_,{className:"h-12 w-full",onClick:m,buttonType:W.PRIMARY,title:g&&C!=="CONFIRM"?"Please type CONFIRM to acknowledge the fee and continue":`Redelegate ${f}`,text:v?"Processing...":`Redelegate ${f}`})}),e.jsx("div",{children:e.jsx("button",{className:"h-[3.25rem] p-4 text-sm",onClick:o,children:"Back"})})]})]})}),v&&e.jsx(ne,{onClose:()=>w(!1),message:"Sign the following data with your wallet to proceed."}),p&&e.jsx(re,{onClose:()=>{S(!1),o(),u()},title:"Congratulations",bodyText:e.jsxs("div",{className:"mb-8 text-sm text-mid",children:[e.jsx("div",{children:"You have successfully redelegated your stake."}),e.jsxs("div",{className:"my-2 flex flex-col justify-center gap-2",children:[e.jsx("div",{children:"Transaction ID:"}),e.jsxs("button",{className:"flex items-center justify-center break-all",title:"View transaction on ao.link",onClick:async()=>{window.open(`https://ao.link/#/message/${b}`,"_blank")},children:[b,e.jsx(ie,{className:"ml-1 size-3"})]})]})]})})]})},sa=({onClose:t,sourceGateway:s,vaultId:i,maxRedelegationStake:a})=>{const n=F(M=>M.walletAddress),d=F(M=>M.ticker),{data:u}=Be(n==null?void 0:n.toString()),[o,c]=l.useState(),[f,h]=l.useState(),[r,b]=l.useState(""),[x,v]=l.useState(),[w,p]=l.useState(!1),[S,C]=l.useState(!1),{data:k}=Ue(n==null?void 0:n.toString()),{data:N}=ve(),[g,j]=l.useState();l.useEffect(()=>{if(N){const M=Object.entries(N).map(([$,Y])=>({...Y,gatewayAddress:$})).filter($=>$.status==="joined"&&$.settings.allowDelegatedStaking&&$.gatewayAddress!==s.gatewayAddress);j(M)}},[N,s.gatewayAddress]),l.useEffect(()=>{var M;if(o&&n){if(o.gatewayAddress===n.toString())h(new L(o.operatorStake).toARIO().valueOf());else if(u){const $=(M=u.stakes.find(Y=>Y.gatewayAddress===o.gatewayAddress))==null?void 0:M.balance;h(new L($??0).toARIO().valueOf())}}},[o,u,n]);const R=o?new L(o==null?void 0:o.settings.minDelegatedStake).toARIO().valueOf():10,m=(f??0)>0?1:R,O=l.useMemo(()=>({redelegationAmount:Ke("Redelegation Amount",d,m,a.valueOf())}),[d,m,a]);l.useEffect(()=>{if(!o){p(!1);return}const M=parseFloat(r),$=a.valueOf(),Y=new L(s.settings.minDelegatedStake).toARIO().valueOf();if(i===void 0&&M!=$&&$-M<Y){v(`Amount to redelegate must either leave enough stake to meet the source gateway's minimum delegated stake (${D(Y)} ${d}) or move the entire stake completely.`),p(!1);return}const ce=O.redelegationAmount(r);if(ce!==void 0){v(ce),p(!1);return}if($<m){v(`Insufficient redelegation balance, at least ${m} ${d} required for target gateway.`),p(!1);return}v(void 0),p(!0)},[r,a,m,s.settings.minDelegatedStake,o,d,O,i]);const E=l.useMemo(()=>k&&r&&w?k.redelegationFeeRate/100*parseFloat(r):0,[k,r,w]),A=parseFloat(r)-E,T=(f??0)+A,q=parseFloat(r.length===0?"0":r),J=q<=a.valueOf()?a.valueOf()-q:-1,me=()=>{b(a+"")},X=!o||a.valueOf()<m;return e.jsx(H,{onClose:t,useDefaultPadding:!1,children:e.jsxs("div",{className:"w-[calc(100vw-2rem)] lg:w-[28.5rem]",children:[e.jsx("div",{className:"border-b border-b-stroke-low",children:e.jsx("div",{className:"rounded-tr-xl border-b border-red-400 bg-grey-700 py-3 text-center",children:e.jsx("span",{className:"text-gradient",children:"Redelegate"})})}),e.jsxs("div",{className:"flex flex-col p-8 pb-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"mb-1",children:e.jsx(Kt,{selectedGateway:o,setSelectedGateway:c,gateways:g})}),e.jsx(y,{label:"Label:",value:o?o.settings.label:"-"}),e.jsx(y,{label:"Domain:",isLink:!0,value:o?o.settings.fqdn:"-"}),e.jsx(y,{label:"Current Stake:",value:`${f?D(f):"0"} ${d}`})]}),e.jsxs("div",{className:"mt-8 flex items-center",children:[e.jsx("div",{className:"text-left text-sm text-mid",children:"Amount:"}),e.jsx("div",{className:"grow"}),e.jsx("div",{className:"text-left text-xs text-low",children:`Available: ${J>=0?D(+J):"-"} ${d}`})]}),e.jsxs("div",{className:"mt-3 flex h-[3.25rem] items-center overflow-hidden rounded-md border border-grey-800",children:[e.jsx("input",{className:"size-full grow  bg-grey-1000 px-6 py-3 text-sm text-mid outline-none placeholder:text-grey-400 focus:text-high",disabled:X,readOnly:X,type:"text",placeholder:`Enter amount of ${d} to stake`,value:r,onChange:M=>{const $=M.target.value;$&&isNaN(+M.target.value)||b($)}}),o&&((r==null?void 0:r.length)>0||a.valueOf()<m)&&x&&e.jsx(Ye,{errorMessage:x,tooltipPadding:"3"}),e.jsx(_,{className:"mr-3 max-h-7",onClick:X?void 0:me,buttonType:W.SECONDARY,active:!0,title:"Max",text:"Max"})]})]}),e.jsxs("div",{className:"flex size-full flex-col gap-2 bg-containerL0 px-8 pb-8 pt-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[E>0&&e.jsx(y,{label:"Fee:",value:`${E} ${d}`,rightIcon:e.jsx(fe,{message:e.jsx("div",{children:e.jsx("p",{children:rt})}),children:e.jsx(We,{className:"size-4 text-text-red"})})}),e.jsx(y,{label:"Total Redelegated Stake:",value:`${w?D(A):"-"} ${d}`}),e.jsx(y,{label:"New Total Stake:",value:`${w?D(T):"-"} ${d}`})]}),e.jsx("div",{className:w?void 0:"pointer-events-none opacity-30",children:e.jsx(_,{className:"mt-4 h-[3.25rem] w-full",onClick:()=>{C(!0)},buttonType:W.PRIMARY,title:"Review",text:"Review"})})]}),S&&o&&n&&e.jsx(Yt,{amountToRedelegate:new Q(parseFloat(r)),fee:E,newTotalStake:T,sourceGateway:s,targetGateway:o,onClose:()=>C(!1),onSuccess:()=>t(),ticker:d,walletAddress:n,vaultId:i})]})})},la=({gatewayAddress:t,vaultId:s,onClose:i})=>{const a=le(),n=F(p=>p.walletAddress),d=F(p=>p.arIOWriteableSDK),[u,o]=l.useState(!1),[c,f]=l.useState(!1),[h,r]=l.useState(),[b,x]=l.useState(""),v=b==="CONFIRM",w=async()=>{if(n&&d){o(!0);try{const{id:p}=await d.cancelWithdrawal({gatewayAddress:t,vaultId:s},z);r(p),a.invalidateQueries({queryKey:["gateways"],refetchType:"all"}),a.invalidateQueries({queryKey:["delegateStakes"],refetchType:"all"}),a.invalidateQueries({queryKey:["gatewayVaults"],refetchType:"all"}),f(!0)}catch(p){oe(`${p}`)}finally{o(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(H,{onClose:i,useDefaultPadding:!1,children:e.jsxs("div",{className:"w-[calc(100vw-2rem)] text-left lg:w-[28.4375rem]",children:[e.jsx("div",{className:"px-8  pb-4 pt-6",children:e.jsx("div",{className:"text-lg text-high",children:"Cancel Pending Withdrawal"})}),e.jsx("div",{className:"border-y border-grey-800 p-8 text-sm text-mid",children:e.jsxs("div",{children:["This action will cancel your withdrawal and return its stake to"," ",t.toString()==(n==null?void 0:n.toString())?"your":"the original"," ","gateway. This action cannot be undone."]})}),e.jsxs("div",{className:"bg-containerL0 px-8 pb-8 pt-6",children:[e.jsxs("div",{className:"mb-6 flex flex-col items-center gap-2 text-sm text-mid",children:[e.jsx("div",{children:'Please type "CONFIRM" in the text box to proceed.'}),e.jsx("input",{type:"text",onChange:p=>x(p.target.value),className:"h-7 w-full rounded-md border border-grey-700 bg-grey-1000 p-4 text-sm text-mid outline-none placeholder:text-grey-400 focus:text-high",value:b})]}),e.jsx("div",{className:"flex grow justify-center",children:e.jsx(_,{onClick:w,buttonType:W.PRIMARY,title:"Cancel Withdrawal",text:e.jsx("div",{className:"py-2",children:"Cancel Withdrawal"}),className:`w-full ${!v&&"pointer-events-none opacity-30"}`})})]})]})}),u&&e.jsx(ne,{onClose:()=>o(!1),message:"Sign the following data with your wallet to proceed."}),c&&e.jsx(re,{onClose:()=>{f(!1),i()},title:"Confirmed",bodyText:e.jsxs("div",{className:"mb-8 text-sm text-mid",children:[e.jsx("div",{children:"You have successfully canceled the withdrawal."}),e.jsxs("div",{className:"my-2 flex flex-col justify-center gap-2",children:[e.jsx("div",{children:"Transaction ID:"}),e.jsxs("button",{className:"flex items-center justify-center break-all",title:"View transaction on ao.link",onClick:async()=>{window.open(`https://ao.link/#/message/${h}`,"_blank")},children:[h,e.jsx(ie,{className:"ml-1 size-3"})]})]})]})})]})},Ne=.5,Bt=.1,Gt=(t,s)=>{const i=Math.max(0,s.getTime()-t.startTimestamp),a=t.endTimestamp-t.startTimestamp;return Ne-(Ne-Bt)*(i/a)},na=({gateway:t,gatewayAddress:s,vaultId:i,vault:a,onClose:n})=>{const d=le(),u=F(g=>g.walletAddress),o=F(g=>g.arIOWriteableSDK),c=F(g=>g.ticker),[f,h]=l.useState(!1),[r,b]=l.useState(!1),[x,v]=l.useState(),[w,p]=l.useState(""),[S,C]=l.useState();l.useEffect(()=>{const g=Gt(a,new Date),j=Math.floor(g*a.balance),R=Math.round(a.balance-j);C({penaltyRate:g,fee:new L(j).toARIO().valueOf(),amountReturning:new L(R).toARIO().valueOf()})},[C,a]);const k=w==="WITHDRAW",N=async()=>{if(u&&o){h(!0);try{const{id:g}=await o.instantWithdrawal({gatewayAddress:s,vaultId:i},z);v(g),d.invalidateQueries({queryKey:["gateways"],refetchType:"all"}),d.invalidateQueries({queryKey:["balances"],refetchType:"all"}),d.invalidateQueries({queryKey:["delegateStakes"],refetchType:"all"}),d.invalidateQueries({queryKey:["gatewayVaults"],refetchType:"all"}),b(!0)}catch(g){oe(`${g}`)}finally{h(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(H,{onClose:n,useDefaultPadding:!1,children:e.jsxs("div",{className:"w-[calc(100vw-2rem)] text-left lg:w-[28.4375rem]",children:[e.jsx("div",{className:"px-8  pb-4 pt-6",children:e.jsx("div",{className:"text-lg text-high",children:"Expedited Withdrawal"})}),e.jsxs("div",{className:"flex flex-col gap-1 px-8",children:[e.jsx(y,{label:"Label:",value:t.settings.label}),e.jsx(y,{label:"Domain:",value:t.settings.fqdn,isLink:!0}),e.jsx(y,{label:"Address:",value:V(s)}),e.jsx(y,{label:"Original Date of Return:",value:Fe(new Date(a.endTimestamp))})]}),e.jsxs("div",{className:"mx-8 mt-4 flex flex-col gap-3 rounded bg-containerL3 p-4  text-[0.8125rem]",children:[e.jsx("div",{className:"grow text-high",children:"You are about to expedite your withdrawal, subject to a dynamic fee. Please note:"}),e.jsxs("ul",{className:"list-disc space-y-2 pl-4",children:[e.jsxs("li",{children:["A fee of"," ",S?(S.penaltyRate*100).toFixed(2):"","% will be applied to your withdrawal based on the current time remaining until your original return date."]}),e.jsx("li",{children:"This action is irreversible once confirmed."}),e.jsx("li",{children:"Your staked tokens will return immediately to your wallet."})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-1 px-8 pb-4",children:[e.jsx(y,{label:"Stake Withdrawing:",value:`${D(new L(a.balance).toARIO().valueOf())} ${c}`}),e.jsx(y,{label:"Early Withdrawal Fee:",value:S?`${D(S.fee)} ${c}`:"",rightIcon:e.jsx(fe,{message:e.jsx("div",{children:e.jsx("p",{children:"Expedited withdrawal fee starts at 50% and declines linearly to 10% over the withdrawal period."})}),children:e.jsx(Qe,{className:"size-[1.125rem]"})})}),e.jsx(y,{label:"Amount Returning:",value:S?`${D(S.amountReturning)} ${c}`:""})]}),e.jsxs("div",{className:"bg-containerL0 px-8 pb-8 pt-4",children:[e.jsxs("div",{className:"mb-6 flex flex-col items-center gap-2 text-sm text-mid",children:[e.jsx("div",{children:'Please type "WITHDRAW" in the text box to proceed.'}),e.jsx("input",{type:"text",onChange:g=>p(g.target.value),className:"h-7 w-full rounded-md border border-grey-700 bg-grey-1000 p-4 text-sm text-mid outline-none placeholder:text-grey-400 focus:text-high",value:w})]}),e.jsx("div",{className:"flex grow justify-center",children:e.jsx(_,{onClick:N,buttonType:W.PRIMARY,title:"Withdraw",text:e.jsx("div",{className:"py-2",children:"Withdraw"}),className:`w-full ${!k&&"pointer-events-none opacity-30"}`})})]})]})}),f&&e.jsx(ne,{onClose:()=>h(!1),message:"Sign the following data with your wallet to proceed."}),r&&e.jsx(re,{onClose:()=>{b(!1),n()},title:"Confirmed",bodyText:e.jsxs("div",{className:"mb-8 text-sm text-mid",children:[e.jsx("div",{children:"You have successfully expedited the withdrawal."}),e.jsxs("div",{className:"my-2 flex flex-col justify-center gap-2",children:[e.jsx("div",{children:"Transaction ID:"}),e.jsxs("button",{className:"flex items-center justify-center break-all",title:"View transaction on ao.link",onClick:async()=>{window.open(`https://ao.link/#/message/${x}`,"_blank")},children:[x,e.jsx(ie,{className:"ml-1 size-3"})]})]})]})})]})},Qt=(t,s)=>{const{data:i}=ve(),{data:a}=Le(),[n,d]=l.useState();return l.useEffect(()=>{if(i&&t&&a&&a>0&&!isNaN(s)){const u=i?Object.values(i).filter(f=>f.status=="joined").length:0,o=ze(new L(a).toARIO(),u,t),c=Pt(o,new Q(Math.abs(s)),s<0);d(c)}},[i,t,a,s]),n},ra=({onClose:t,ownerWallet:s})=>{const i=F(A=>A.walletAddress),{data:a}=it(i),n=F(A=>A.ticker),[d,u]=l.useState(0),[o,c]=l.useState(""),[f,h]=l.useState(!1),{data:r}=vt({ownerWalletAddress:s}),{data:b}=Be(i==null?void 0:i.toString());l.useEffect(()=>{var T;if(!r||!b)return;const A=(T=b.stakes.find(q=>q.gatewayAddress===r.gatewayAddress))==null?void 0:T.balance;u(new L(A??0).toARIO().valueOf())},[b,r]);const x=(r==null?void 0:r.settings.allowDelegatedStaking)??!1,v=d+parseFloat(o),w=parseFloat(o),p=Qt(r,w),S=p&&v>0&&!isNaN(p.EAY)?(p.EAY*100).toLocaleString("en-us",{maximumFractionDigits:2})+"%":"-",C=r?new L(r==null?void 0:r.settings.minDelegatedStake).toARIO().valueOf():10,k=d>0?1:C,N={address:pt("Gateway Owner"),stakeAmount:Ke("Stake Amount",n,k,a==null?void 0:a.ario)},g=()=>!r||!x?!1:N.stakeAmount(o)==null,j=parseFloat(o.length===0?"0":o),R=a&&j<=a.ario?a.ario-j:-1,m=()=>{c(((a==null?void 0:a.ario)||0)+"")},O=!r||((a==null?void 0:a.ario)||0)<k||!x,E={stakeAmount:N.stakeAmount(o),cannotStake:((a==null?void 0:a.ario)||0)<k?`Insufficient balance, at least ${k} IO required.`:x?void 0:"Gateway does not allow delegated staking."};return e.jsx(H,{onClose:t,useDefaultPadding:!1,children:e.jsxs("div",{className:"w-[calc(100vw-2rem)] lg:w-[28.5rem]",children:[e.jsx("div",{className:"border-b border-b-stroke-low",children:e.jsx("div",{className:"rounded-tr-xl border-b border-red-400 bg-grey-700 py-3 text-center",children:e.jsx("span",{className:"text-gradient",children:"Stake"})})}),e.jsxs("div",{className:"flex flex-col p-8 pb-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(y,{label:"Gateway Owner:",value:V(s)}),e.jsx(y,{label:"Label:",value:r?r.settings.label:"-"}),e.jsx(y,{label:"Domain:",isLink:!0,value:r?r.settings.fqdn:"-"})]}),e.jsxs("div",{className:"mt-8 flex items-center",children:[e.jsx("div",{className:"text-left text-sm text-mid",children:"Amount:"}),e.jsx("div",{className:"grow"}),e.jsx("div",{className:"text-left text-xs text-low",children:a&&`Available: ${R>=0?D(+R):"-"} ${n}`})]}),e.jsxs("div",{className:"mt-3 flex h-[3.25rem] items-center overflow-hidden rounded-md border border-grey-800",children:[e.jsx("input",{className:"size-full grow  bg-grey-1000 px-6 py-3 text-sm text-mid outline-none placeholder:text-grey-400 focus:text-high",disabled:O,readOnly:O,type:"text",placeholder:`Enter amount of ${n} to stake`,value:o,onChange:A=>{const T=A.target.value;T&&isNaN(+A.target.value)||c(T)}}),r&&((o==null?void 0:o.length)>0||((a==null?void 0:a.ario)||0)<k||!x)&&(E.cannotStake||E.stakeAmount)&&e.jsx(Ye,{errorMessage:E.cannotStake??E.stakeAmount,tooltipPadding:"3"}),e.jsx(_,{className:"mr-3 h-7",onClick:O?void 0:m,buttonType:W.SECONDARY,active:!0,title:"Max",text:"Max"})]})]}),e.jsxs("div",{className:"flex size-full flex-col gap-2 bg-containerL0 px-8 pb-8 pt-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(y,{label:"Existing Stake:",value:`${d} ${n}`}),e.jsx(y,{label:"New Total Stake:",value:`${g()?D(d+parseFloat(o)):"-"} ${n}`}),e.jsx(y,{label:"Delegate EAY:",value:S,rightIcon:e.jsx(fe,{message:e.jsxs("div",{children:[e.jsx("p",{children:Pe}),e.jsx(Ge,{className:"mt-4",children:_e})]}),children:e.jsx(Qe,{className:"size-[1.125rem]"})})})]}),e.jsx("div",{className:g()?void 0:"pointer-events-none opacity-30",children:e.jsx(_,{className:"mt-4 h-[3.25rem] w-full",onClick:()=>{h(!0)},buttonType:W.PRIMARY,title:"Review",text:"Review"})})]}),f&&r&&i&&e.jsx(Wt,{amountToStake:parseFloat(o),gateway:r,onClose:()=>h(!1),onSuccess:()=>t(),ticker:n,walletAddress:i})]})})};export{ea as C,na as I,Ge as M,Wt as R,Qe as S,$t as V,_t as W,Xt as a,Zt as b,ta as c,aa as d,sa as e,la as f,ra as g,ze as h};
//# sourceMappingURL=StakingModal-0EdW_tTe.js.map
