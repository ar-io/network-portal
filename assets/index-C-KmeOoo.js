import{r as x,aO as z,a as L,aP as T,l as q,e as f,j as e,P as v,ab as ee,aQ as se,aR as ae,aS as te,af as le,u as U,q as ne,m as V,N as re,aT as ce,H as oe,aU as ie}from"./index-DQHvdTxE.js";import{u as de}from"./useDelegateStakes-D3q4ooBY.js";import{u as ue,c as xe}from"./TableSkeletonRow-zrttk92L.js";import{u as me}from"./useVaults-Dm45KY_I.js";import{A as he}from"./AddressCell-B1rVsCfI.js";import{C as ge}from"./ColumnSelector-BE6fw_Y1.js";import{S as Q,a as fe}from"./ServerSortableTableView-BKj2xuUh.js";import{S as W}from"./caret_double_right-Cfix3Ety.js";import{S as pe}from"./search-B5ZvmDow.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l=new Error().stack;l&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[l]="95ea3792-2cf0-49a6-b3a5-cccd828144bd",s._sentryDebugIdIdentifier="sentry-dbid-95ea3792-2cf0-49a6-b3a5-cccd828144bd")}catch{}})();const R=1e9,be=({active:s,payload:l})=>{if(s&&l&&l.length){const t=l[0].payload;return e.jsxs("div",{className:"rounded-md bg-containerL3 p-3 shadow-lg",children:[e.jsx("p",{className:"text-sm font-semibold text-high",children:t.name}),e.jsxs("p",{className:"text-xs text-mid",children:[f(t.value)," ",t.ticker]}),e.jsxs("p",{className:"text-xs text-low",children:[q(t.percentage)," of total supply"]}),t.address&&e.jsx("p",{className:"mt-1 break-all text-xs font-mono text-low opacity-70",children:t.address})]})}return null},je=()=>{const[s,l]=x.useState([]),[t,m]=x.useState(),{data:h,isLoading:u}=z(),g=L(d=>d.ticker),o=L(d=>d.arIOReadSDK.process.processId);x.useEffect(()=>{if(h&&h.length>0){const d=h.find(i=>i.address===o),n=(d==null?void 0:d.arioBalance)||0,y=h.find(i=>i.address===T),p=(y==null?void 0:y.arioBalance)||0,c=[];n>0&&c.push({name:"Protocol Balance",value:n,percentage:n/R,address:o,ticker:g}),p>0&&c.push({name:"Bridge Balance",value:p,percentage:p/R,address:T,ticker:g});const E=h.filter(i=>i.address!==o&&i.address!==T).slice(0,18);E.forEach((i,N)=>{c.push({name:`Wallet ${N+1}`,value:i.arioBalance,percentage:i.arioBalance/R,address:i.address,ticker:g})});const P=(d?1:0)+(y?1:0),S=h.length-E.length-P;if(S>0){const i=h.filter(N=>N.address!==o&&N.address!==T).slice(18).reduce((N,j)=>N+j.arioBalance,0);c.push({name:`Others (${S} addresses)`,value:i,percentage:i/R,address:"",ticker:g})}l(c)}},[h,o]);const k=(d,n)=>{m(n)},b=()=>{m(void 0)},C=s&&t!==void 0?q(s[t].percentage):s.length>0?`${f((h==null?void 0:h.length)||0)} holders`:"0 holders",w=s&&t!==void 0?s[t].name:"Total Addresses";return e.jsxs("div",{className:"flex w-full flex-col rounded-xl border border-grey-500",children:[e.jsxs("div",{className:"px-5 pt-5 pb-2",children:[e.jsx("h3",{className:"text-gradient text-sm font-semibold",children:"Balance Distribution"}),e.jsxs("p",{className:"mt-1 text-xs text-low",children:[f(R)," ",g," total supply"]})]}),e.jsx("div",{className:"relative h-64 w-full p-5",children:u?e.jsx("div",{className:"flex size-full items-center justify-center",children:e.jsx(v,{className:"h-4"})}):s.length>0?e.jsxs(e.Fragment,{children:[e.jsx(ee,{width:"100%",height:"100%",children:e.jsxs(se,{children:[e.jsx(ae,{data:s,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,stroke:"none",paddingAngle:2,onMouseEnter:k,onMouseLeave:b,startAngle:90,endAngle:-270,children:s.map((d,n)=>e.jsx(te,{fill:d.address===o?n===t?"#E19EE580":"#E19EE520":d.address===T?n===t?"#FF8C00":"#FF8C0050":n===t?"#E19EE540":"#E19EE510"},`cell-${n}`))}),e.jsx(le,{content:e.jsx(be,{})})]})}),e.jsxs("div",{className:"pointer-events-none absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"text-2xl font-semibold text-high",children:C}),e.jsx("div",{className:"text-xs text-mid",children:w})]})]}):e.jsx("div",{className:"flex size-full items-center justify-center",children:e.jsx("p",{className:"text-sm text-mid",children:"No balance data available"})})})]})},ve=()=>{const s=L(c=>c.walletAddress),l=L(c=>c.ticker),t=U(),{data:m,isLoading:h}=ne(s),{data:u,isLoading:g}=me(),{data:o,isLoading:k}=de(s==null?void 0:s.toString()),{data:b,isLoading:C,isFetched:w}=ue({ownerWalletAddress:s==null?void 0:s.toString()}),d=x.useMemo(()=>!u||!s?[]:u.filter(c=>c.controller===s.toString()),[u,s]),n=x.useMemo(()=>{const c=(m==null?void 0:m.ario)||0,E=(o==null?void 0:o.stakes.reduce((j,D)=>j+new V(D.balance).toARIO().valueOf(),0))||0,P=(o==null?void 0:o.withdrawals.reduce((j,D)=>j+new V(D.balance).toARIO().valueOf(),0))||0,S=w&&b?new V(b.operatorStake).toARIO().valueOf():0,i=d.reduce((j,D)=>j+new V(D.balance).toARIO().valueOf(),0),N=c+E+P+S+i;return{liquid:c,delegated:E,withdrawing:P,operator:S,locked:i,total:N}},[m==null?void 0:m.ario,o,b,w,d]),y=()=>{s&&t(`/balances/${s}`)},p=h||g||k||C;return s?e.jsxs("div",{className:"flex w-full flex-col rounded-xl border border-grey-500",children:[e.jsxs("div",{className:"px-5 pt-5 pb-3",children:[e.jsxs("h3",{className:"text-gradient text-sm font-semibold",children:["My ",l," Balances"]}),e.jsx("p",{className:"mt-1 text-xs text-low",children:"Your wallet balances and stakes"})]}),e.jsxs("div",{className:"flex flex-col gap-3 px-5 pb-5",children:[e.jsxs("div",{className:"flex flex-col border-b border-grey-600 pb-3",children:[e.jsxs("span",{className:"text-xs text-low",children:["Total ",l]}),p?e.jsx(v,{className:"mt-1 h-6 w-24"}):e.jsx("span",{className:"text-2xl font-semibold text-gradient",children:f(n.total)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-low",children:"Liquid"}),p?e.jsx(v,{className:"h-4 w-16"}):e.jsx("span",{className:"text-sm font-semibold text-high",children:f(n.liquid)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-low",children:"Delegated"}),p?e.jsx(v,{className:"h-4 w-16"}):e.jsx("button",{onClick:()=>t("/staking"),className:"text-sm font-semibold text-primary hover:text-high transition-colors underline",title:"View staking details",children:f(n.delegated)})]}),(n.operator>0||C)&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-low",children:"Operator"}),p?e.jsx(v,{className:"h-4 w-16"}):e.jsx("span",{className:"text-sm font-semibold text-high",children:f(n.operator)})]}),(n.withdrawing>0||k)&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-low",children:"Withdrawing"}),p?e.jsx(v,{className:"h-4 w-16"}):e.jsx("span",{className:"text-sm font-semibold text-high",children:f(n.withdrawing)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-xs text-low",children:["Locked (",d.length," vault",d.length!==1?"s":"",")"]}),p?e.jsx(v,{className:"h-4 w-16"}):e.jsx("button",{onClick:y,className:"text-sm font-semibold text-primary hover:text-high transition-colors underline",title:"Click to view vaults",children:f(n.locked)})]})]})]}):null},Ne=(s={})=>{const l=re(),t=L(u=>u.arIOReadSDK),m=x.useCallback(async(u,g)=>{if(!t)return;const o=["allBalances",t,u,g];if(!l.getQueryData(o))try{await l.prefetchQuery({queryKey:o,queryFn:async()=>{const b=[];let C=!0,w;const d=1e3;for(;C;){const n=await t.getBalances({cursor:w,limit:d,sortBy:u,sortOrder:g});b.push(...n.items),C=n.hasMore,w=n.nextCursor}return b.map(n=>({...n,arioBalance:new V(n.balance).toARIO().valueOf()}))},staleTime:5*60*1e3})}catch(b){console.debug("Failed to prefetch balances:",u,g,b)}},[t,l]),h=x.useCallback((u,g)=>{m(u,g==="asc"?"desc":"asc"),m(u==="balance"?"address":"balance",g)},[m]);return{prefetchBalances:m,prefetchNextSort:h}},I=xe(),M=10,we=()=>{var K,H;const s=L(a=>a.ticker),[l,t]=x.useState(1),[m,h]=x.useState(""),[u,g]=x.useState(""),[o,k]=x.useState([{id:"liquidBalance",desc:!0}]),b=L(a=>{var r,B;return((B=(r=a.arIOReadSDK)==null?void 0:r.process)==null?void 0:B.processId)??""}),C=U();x.useEffect(()=>{const a=setTimeout(()=>{g(m.trim()),t(1)},300);return()=>clearTimeout(a)},[m]);const w=(K=o[0])==null?void 0:K.id,d=(H=o[0])==null?void 0:H.desc,y=w&&{address:"address",liquidBalance:"balance"}[w]||"balance",p=d?"desc":"asc",{data:c,isLoading:E,isFetching:P}=z({sortBy:y,sortOrder:p}),{data:S,isLoading:i}=ce(),{prefetchNextSort:N}=Ne(),[j,D]=x.useState([]),[Y,J]=x.useState(!0);x.useEffect(()=>{if(!c)return;const a=c.filter(r=>r.address!==b.toString()&&r.address!==T).map((r,B)=>{const A=(S==null?void 0:S.get(r.address))||{vaultCount:0,totalVaultBalance:0},G=r.arioBalance+A.totalVaultBalance;return{rank:B+1,address:r.address,liquidBalance:r.arioBalance,vaultCount:A.vaultCount,vaultBalance:A.totalVaultBalance,totalBalance:G,percentageOfSupply:G/1e9,isProtocol:!1}}).map((r,B)=>({...r,rank:B+1}));D(a),J(!1)},[c,S,b]),x.useEffect(()=>{c!=null&&c.length&&N(y,p)},[c==null?void 0:c.length,y,p,N]);const F=x.useMemo(()=>{if(!u)return j;const a=u.toLowerCase();return j.filter(r=>r.address.toLowerCase().includes(a))},[j,u]),O=Math.ceil(F.length/M),X=x.useMemo(()=>{const a=(l-1)*M,r=a+M;return F.slice(a,r)},[F,l]),$=x.useMemo(()=>[I.accessor("rank",{id:"rank",header:"Rank",enableSorting:!1,cell:({row:a})=>e.jsxs("span",{className:"text-sm text-mid",children:["#",a.getValue("rank")]})}),I.accessor("address",{id:"address",header:"Address",sortDescFirst:!1,cell:({row:a})=>e.jsx(he,{address:a.getValue("address")})}),I.accessor("liquidBalance",{id:"liquidBalance",header:`Liquid ${s}`,sortDescFirst:!0,cell:({row:a})=>f(a.getValue("liquidBalance"))}),I.accessor("vaultCount",{id:"vaultCount",header:"Vaults",enableSorting:!1,cell:({row:a})=>{if(i)return e.jsx(v,{className:"h-4 w-8"});const r=a.getValue("vaultCount");return r>0?f(r):"-"}}),I.accessor("vaultBalance",{id:"vaultBalance",header:`Total Vaulted ${s}`,enableSorting:!1,cell:({row:a})=>{if(i)return e.jsx(v,{className:"h-4 w-12"});const r=a.getValue("vaultBalance");return r>0?f(r):"-"}}),I.accessor("totalBalance",{id:"totalBalance",header:`Total ${s}`,enableSorting:!1,cell:({row:a})=>i?e.jsx(v,{className:"h-4 w-16"}):e.jsx("span",{className:"font-semibold text-primary",children:f(a.getValue("totalBalance"))})}),I.accessor("percentageOfSupply",{id:"percentageOfSupply",header:"% of Supply",enableSorting:!1,cell:({row:a})=>{if(i)return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-2 w-20 rounded-full"}),e.jsx(v,{className:"h-3 w-8"})]});const r=a.getValue("percentageOfSupply"),B=r*100,A=B<1;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"relative h-2 w-20 rounded-full border border-grey-600 bg-containerL2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#E19EE5] to-[#A19EE5] transition-all duration-300 ease-out",style:{width:A?"0%":`${Math.min(B,100)}%`}})}),e.jsx("span",{className:"text-xs text-mid min-w-fit",children:q(r)})]})}})],[s,i]),_=E||Y,Z=a=>{k(a),t(1)};return e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex w-full items-center overflow-x-auto justify-between rounded-t-xl border border-grey-600 bg-containerL3 py-2 pl-6 pr-[0.8125rem]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-mid",children:["All Token Holders"," ",!_&&`(${f(F.length)}${u?` of ${f(j.length)}`:""})`]}),e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 size-4 -translate-y-1/2 text-low"}),e.jsx("input",{type:"text",placeholder:"Search address...",value:m,onChange:a=>h(a.target.value),className:"w-[400px] rounded-md border border-grey-700 bg-grey-1000 py-1.5 pl-9 pr-3 text-sm text-mid outline-none placeholder:text-grey-400 focus:text-high"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[O>1&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>t(1),disabled:l===1,className:"rounded-md bg-containerL2 p-1 text-mid transition-all hover:bg-containerL1 disabled:opacity-50","aria-label":"First page",children:e.jsx(W,{className:"h-4 w-4 rotate-180"})}),e.jsx("button",{onClick:()=>t(Math.max(1,l-1)),disabled:l===1,className:"rounded-md bg-containerL2 p-1 text-mid transition-all hover:bg-containerL1 disabled:opacity-50","aria-label":"Previous page",children:e.jsx(Q,{className:"h-4 w-4 rotate-180"})}),e.jsxs("span",{className:"text-xs text-mid",children:["Page ",l," of ",O]}),e.jsx("button",{onClick:()=>t(Math.min(O,l+1)),disabled:l===O,className:"rounded-md bg-containerL2 p-1 text-mid transition-all hover:bg-containerL1 disabled:opacity-50","aria-label":"Next page",children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>t(O),disabled:l===O,className:"rounded-md bg-containerL2 p-1 text-mid transition-all hover:bg-containerL1 disabled:opacity-50","aria-label":"Last page",children:e.jsx(W,{className:"h-4 w-4"})})]}),e.jsx(ge,{tableId:"balances",columns:$})]})]}),e.jsx(fe,{columns:$,data:X,defaultSortingState:{id:"liquidBalance",desc:!0},currentSorting:o,onSortingChange:Z,isLoading:_,isFetching:P,isError:!1,noDataFoundText:"No balances found.",errorText:"Unable to load balances.",loadingRows:M,onRowClick:a=>{C(`/balances/${a.address}`)},tableId:"balances"})]})},Pe=()=>{const s=L(l=>l.walletAddress);return e.jsxs("div",{className:"px-4 lg:px-6 flex h-full max-w-full flex-col ",children:[e.jsx("div",{className:"mb-4 shrink-0",children:e.jsx(oe,{})}),e.jsx("div",{className:"flex-1 overflow-scroll scrollbar scrollbar-thin",children:e.jsxs("div",{className:"flex flex-col gap-6 pb-6",children:[e.jsxs("div",{className:`grid grid-cols-1 ${s?"lg:grid-cols-3":"lg:grid-cols-2"} gap-6`,children:[e.jsx(je,{}),e.jsx(ie,{}),s&&e.jsx(ve,{})]}),e.jsx(we,{})]})})]})};export{Pe as default};
//# sourceMappingURL=index-C-KmeOoo.js.map
