import{r as n,j as e,e as w,n as A,L as b,P as x,o as k,y as O,M as C}from"./index-DQHvdTxE.js";import{c as I,u as D}from"./TableSkeletonRow-zrttk92L.js";import{D as T,d as F,F as H,u as W}from"./FileSaver.min-BPxwNo2N.js";import{A as y}from"./AddressCell-B1rVsCfI.js";import{B as h,A as L}from"./AssessmentDetailsPanel-Bc-r6IB0.js";import{C as E}from"./ColumnSelector-BE6fw_Y1.js";import{T as _}from"./TableView-BlLijkS0.js";import{S as z}from"./search-B5ZvmDow.js";import{C as v}from"./chevron-right-B_PL71Dp.js";import{N as P}from"./notebook-text-D3g-Chey.js";import"./caret_double_right-Cfix3Ety.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},r=new Error().stack;r&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[r]="ab328a1e-8014-4bc9-68b1-51a7dfdfbd76",a._sentryDebugIdIdentifier="sentry-dbid-ab328a1e-8014-4bc9-68b1-51a7dfdfbd76")}catch{}})();const m=I(),N={passed:0,failed:1,skipped:2},$=({gateway:a,reportData:r})=>{const[l,i]=n.useState(),[o,d]=n.useState(),[u,R]=n.useState(""),[f,S]=n.useState("");n.useEffect(()=>{const s=setTimeout(()=>{S(u.trim())},300);return()=>clearTimeout(s)},[u]);const p=n.useMemo(()=>Object.entries(r.gatewayAssessments).flatMap(([s,t])=>t.ownershipAssessment.expectedWallets.map(c=>({observedHost:s,expectedOwner:c,observedOwner:t.ownershipAssessment.observedWallet,ownershipResult:t.ownershipAssessment.pass,arnsResult:t.arnsAssessments.pass,overallResult:t.pass,offsetAssessmentStatus:t.offsetAssessments?t.offsetAssessments.pass?"passed":"failed":"skipped",assessment:t}))),[r]),g=n.useMemo(()=>{if(!p||!f)return p;const s=f.toLowerCase();return p.filter(t=>{var c;return t.observedHost.toLowerCase().includes(s)||t.expectedOwner.toLowerCase().includes(s)||(((c=t.observedOwner)==null?void 0:c.toLowerCase().includes(s))??!1)})},[p,f]),j=n.useMemo(()=>[m.accessor("observedHost",{id:"observedHost",header:"Observed Host",sortDescFirst:!1}),m.accessor("expectedOwner",{id:"expectedOwner",header:"Expected Owner",sortDescFirst:!1,cell:({row:s})=>{const t=s.original.expectedOwner;return t?e.jsx(y,{address:t}):""}}),m.accessor("observedOwner",{id:"observedOwner",header:"Observed Owner",sortDescFirst:!1,cell:({row:s})=>{const t=s.original.observedOwner;return t?e.jsx(y,{address:t}):""}}),m.accessor("ownershipResult",{id:"ownershipResult",header:"Ownership Result",sortDescFirst:!1,cell:({row:s})=>e.jsx(h,{value:s.original.ownershipResult})}),m.accessor("arnsResult",{id:"arnsResult",header:"ArNS Result",sortDescFirst:!1,cell:({row:s})=>e.jsx(h,{value:s.original.arnsResult})}),m.accessor("offsetAssessmentStatus",{id:"offsetAssessments",header:"Offset Assessments",sortDescFirst:!1,enableSorting:!0,sortingFn:(s,t,c)=>N[s.getValue(c)]-N[t.getValue(c)],cell:({getValue:s})=>{const t=s();return t==="skipped"?e.jsx("div",{className:"pr-6",children:e.jsx("div",{className:"flex w-fit items-center rounded-xl border border-grey-500 bg-grey-700/40 px-2 py-0.5 text-xs text-low",children:"Skipped"})}):e.jsx("div",{className:"pr-6",children:e.jsx(h,{value:t==="passed",additionalClasses:"text-xs",customText:t==="passed"?"Passed":"Failed"})})}}),m.accessor("overallResult",{id:"overallResult",header:"Overall Result",sortDescFirst:!1,cell:({row:s})=>e.jsx("div",{className:"pr-6",children:e.jsx(h,{value:s.original.overallResult})})})],[]);return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex w-full items-center justify-between overflow-x-auto rounded-t-xl border border-grey-600 bg-containerL3 py-2 pl-6 pr-[0.8125rem] text-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-mid",children:["Gateway Assessments"," ",`(${w(g.length)}${f?` of ${w(p.length)}`:""})`]}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute left-3 top-1/2 size-4 -translate-y-1/2 text-low"}),e.jsx("input",{type:"text",placeholder:"Search by host or owner...",value:u,onChange:s=>R(s.target.value),className:"w-[300px] rounded-md border border-grey-700 bg-grey-1000 py-1.5 pl-9 pr-3 text-sm text-mid outline-none placeholder:text-grey-400 focus:text-high"})]})]}),e.jsx(E,{tableId:"gateway-assessments",columns:j})]}),e.jsx(_,{columns:j,data:g,isLoading:!1,noDataFoundText:"No reports found.",defaultSortingState:{id:"observedHost",desc:!1},onRowClick:s=>{i(s.observedHost),d(s.assessment)},tableId:"gateway-assessments"}),o&&a&&e.jsx(L,{observedHost:l,assessment:o,onClose:()=>d(void 0)})]})},G=({gateway:a,reportData:r})=>{const l=A(),i=l==null?void 0:l.ownerId,o=l==null?void 0:l.reportId;return e.jsxs("header",{className:"flex-col text-clip rounded-xl leading-[1.4] lg:mt-6 lg:border dark:border-transparent-100-8 dark:bg-grey-1000 dark:text-grey-300",children:[e.jsxs("div",{className:"flex items-center gap-3 py-5 pl-6 pr-4 text-sm",children:[e.jsxs("div",{className:"hidden items-center gap-3 lg:flex",children:[e.jsx("div",{className:"text-mid",children:e.jsx(b,{to:"/gateways",children:"Gateways"})}),e.jsx(v,{className:"size-4 text-mid",strokeWidth:1.5}),a?e.jsx(b,{className:"text-mid",to:`/gateways/${i}`,children:a.settings.label}):e.jsx(x,{}),e.jsx(v,{className:"size-4 text-mid",strokeWidth:1.5}),e.jsx(b,{className:"text-mid",to:`/gateways/${i}/reports`,children:"Reports"}),e.jsx(v,{className:"size-4 text-mid",strokeWidth:1.5}),o?e.jsx("div",{children:o}):e.jsx(x,{})]}),e.jsx("div",{className:"grow"}),e.jsx("div",{className:"items-center",children:e.jsx(k,{})})]}),e.jsxs("div",{className:"relative flex items-center gap-3 rounded-t-xl border border-grey-500 bg-grey-900 px-6 py-4 lg:rounded-t-none",children:[e.jsx(P,{className:"size-4 shrink-0 text-mid",strokeWidth:1.5}),o?e.jsx("div",{className:"break-all text-high",children:o}):e.jsx(x,{}),e.jsx("div",{className:"grow"}),r&&o&&e.jsx(O,{title:"Download Report",icon:e.jsx(T,{className:"size-4",strokeWidth:2}),active:!0,onClick:async()=>{if(o&&r){const d=await F(o),u=new Blob([d],{type:"application/json"});H.saveAs(u,`report-${o}.json`)}}})]}),e.jsxs("div",{className:"grid grid-cols-[120px_auto] items-center gap-3 rounded-b-xl border border-grey-500 bg-grey-900 py-5 pl-6 text-sm lg:grid-cols-[180px_auto]",children:[e.jsx("div",{children:"Reports Source:"}),r?e.jsx("div",{children:"Arweave Tx"}):e.jsx(x,{}),e.jsx("div",{children:"Observer Address:"}),r?e.jsx("div",{children:r.observerAddress}):e.jsx(x,{}),e.jsx("div",{children:"Epoch Number:"}),r?e.jsx("div",{children:r.epochIndex}):e.jsx(x,{}),e.jsx("div",{children:"Generated At:"}),r?e.jsx("div",{children:C(new Date(r.epochStartTimestamp))}):e.jsx(x,{})]})]})},ee=()=>{const a=A(),r=a==null?void 0:a.ownerId,l=a==null?void 0:a.reportId,{data:i}=D({ownerWalletAddress:r}),{isLoading:o,data:d}=W(l);return e.jsxs("div",{className:"flex h-full max-w-full flex-col gap-6 px-4 pb-6 lg:px-6",children:[e.jsx(G,{gateway:i,reportData:d}),e.jsx("div",{className:"flex-1 overflow-hidden",children:o||!d?void 0:d?e.jsx("div",{className:"h-full overflow-y-auto scrollbar scrollbar-thin",children:e.jsx($,{gateway:i,reportData:d})}):e.jsxs("div",{children:["Unable to find report with ID ",l,"."]})})]})};export{ee as default};
//# sourceMappingURL=index-DgUIQJ2V.js.map
