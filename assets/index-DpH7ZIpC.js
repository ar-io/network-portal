import{r as n,e as V,a as N,g as Y,A as ce,j as e,R as k,d as D,h as Q,P as C,i as ge,L as B,k as Ke,l as Ue,m as je,n as be,b as J,o as X,B as Z,p as Ne,q as I,s as $,T as Se,E as ke,t as He,O as Qe,I as Je,v as H,w as we,x as Ae,y as Re,z as Xe,W as Oe,D as Ie,C as Ze,F as es,G as Ce,u as Te,J as De,S as ss,K as ts,M as rs}from"./index-DT_KQEYq.js";import{S as as,u as Ee,R as T,c as ls,i as xe,F as ns}from"./formData-C8nk42AS.js";import{v as Me,E as Le,a as os,Q as me,b as ue,c as is,d as ds,e as cs,f as xs}from"./validation-DxHxJWOA.js";import{T as Pe,c as Fe,R as $e,a as ye,C as We,I as z,u as ms}from"./index-tbIpH_Tt.js";import{A as us}from"./AddressCell-D_f8F7jC.js";import{C as hs}from"./chevron-right-Dn4_GTmY.js";import{N as ee}from"./notebook-text-ru6OBw6G.js";import{L as O,S as ze}from"./useDelegateStakes-D2fz13wy.js";import{c as qe,M as Ge,S as ps,R as fs,a as vs,V as he,C as pe,b as fe,d as gs,e as Be,f as js,I as bs,g as Ns}from"./StakingModal-0EdW_tTe.js";import{D as Ve}from"./Dropdown-DDaUOJ8r.js";import"./search-CFp1EMlw.js";import"./chevron-down-CWFu1ckq.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new Error().stack;s&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[s]="124b2d5a-902b-4f00-a6c6-62b9cf3bd74f",t._sentryDebugIdIdentifier="sentry-dbid-124b2d5a-902b-4f00-a6c6-62b9cf3bd74f")}catch{}})();const Ss=t=>n.createElement("svg",{width:12,height:12,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},n.createElement("g",{id:"Frame"},n.createElement("path",{id:"Vector",d:"M6 10H10.5",stroke:"#A3A3AD",strokeLinecap:"round",strokeLinejoin:"round"}),n.createElement("path",{id:"Vector_2",d:"M8.25 1.75011C8.44891 1.5512 8.7187 1.43945 9 1.43945C9.13929 1.43945 9.27721 1.46689 9.4059 1.52019C9.53458 1.57349 9.65151 1.65162 9.75 1.75011C9.84849 1.8486 9.92662 1.96553 9.97992 2.09422C10.0332 2.2229 10.0607 2.36083 10.0607 2.50011C10.0607 2.6394 10.0332 2.77733 9.97992 2.90601C9.92662 3.0347 9.84849 3.15162 9.75 3.25011L3.5 9.50011L1.5 10.0001L2 8.00011L8.25 1.75011Z",stroke:"#A3A3AD",strokeLinecap:"round",strokeLinejoin:"round"}),n.createElement("path",{id:"Vector_3",d:"M7.5 2.5L9 4",stroke:"#A3A3AD",strokeLinecap:"round",strokeLinejoin:"round"}))),se=t=>n.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},n.createElement("g",{id:"Frame"},n.createElement("path",{id:"Vector",d:"M10 6.66797L13.3333 10.0013L10 13.3346",stroke:"#7F7F87",strokeLinecap:"round",strokeLinejoin:"round"}),n.createElement("path",{id:"Vector_2",d:"M2.66797 2.66797V7.33464C2.66797 8.04188 2.94892 8.72016 3.44902 9.22025C3.94911 9.72035 4.62739 10.0013 5.33464 10.0013H13.3346",stroke:"#7F7F87",strokeLinecap:"round",strokeLinejoin:"round"})));/**
 * @license lucide-react v0.461.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=V("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.461.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=V("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.461.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=V("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.461.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=V("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.461.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=V("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Is="https://turbo.ardrive.io",Cs=t=>{const s=N(l=>l.arweave),o=N(l=>l.blockHeight);return Y({queryKey:["observerBalances",t,o],queryFn:async()=>{if(!t||!s)throw new Error("Observer address or arweave client is not initialized");const l=await s.wallets.getBalance(t),i=+ce.winstonToAr(l);try{const c=await fetch(`${Is}/v1/account/balance?address=${t}`,{method:"GET"});if(!c.ok)throw new Error(`Failed to fetch Turbo balance: ${c.statusText}`);const r=await c.json(),f=+ce.winstonToAr(r.balance||"0");return{ar:i,turboCredits:f}}catch(c){return console.error("Error fetching Turbo balance:",c),{ar:i,turboCredits:0}}},staleTime:5*60*1e3,enabled:!!t&&!!s&&typeof window<"u"&&"arweaveWallet"in window})},Ts=t=>{const s=N(a=>a.arIOReadSDK);return Y({queryKey:["gatewayDelegates",t,s],queryFn:async()=>{if(!t)throw new Error("Address is not set");let a,l=[];do{const i=await s.getGatewayDelegates({address:t,cursor:a,limit:100});l=l.concat(i.items),a=i.nextCursor}while(a!==void 0);return l.filter(i=>i.delegatedStake>0)},staleTime:1/0,enabled:!!t&&!!s})},Ye=({title:t,children:s,titleRight:o})=>{const[a,l]=n.useState(!1);return e.jsxs("div",{className:"w-full rounded-xl border border-transparent-100-16 text-sm",children:[e.jsxs("div",{className:`flex items-center gap-2 border-b border-grey-500 bg-containerL3 px-6 py-4 ${a?"rounded-t-xl":"rounded-xl"}`,children:[e.jsx("div",{className:"grow",children:s?e.jsxs("button",{className:"flex gap-2",onClick:()=>l(!a),children:[a?e.jsx(Rs,{className:"size-5"}):e.jsx(ws,{className:"size-5"}),e.jsx("div",{children:t})]}):e.jsx("div",{className:"items-center whitespace-nowrap text-high",children:t})}),o]}),a&&s]})},K=Fe(),Ds=({gateway:t})=>{const s=N(r=>r.ticker),{isLoading:o,data:a}=Ts(t==null?void 0:t.gatewayAddress),[l,i]=n.useState([]);n.useEffect(()=>{if(t&&a){const r=t.totalDelegatedStake,f=a.map(m=>{const h=new k(m.delegatedStake).toARIO().valueOf(),x=r>0?m.delegatedStake/r:0;return{walletAddress:m.address,totalStake:h,percentageOfTotalStake:x}});i(f)}},[a,t]);const c=[K.accessor("walletAddress",{id:"walletAddress",header:"Wallet Address",sortDescFirst:!1,cell:({row:r})=>e.jsx(us,{address:r.original.walletAddress})}),K.accessor("totalStake",{id:"totalStake",header:"Total Stake",sortDescFirst:!1,cell:({row:r})=>`${D(r.original.totalStake)} ${s}`}),K.accessor("percentageOfTotalStake",{id:"percentageOfTotalStake",header:"Percentage of Total Delegated Stake",sortDescFirst:!1,cell:({row:r})=>Q(r.original.percentageOfTotalStake)})];return e.jsx(Ye,{title:e.jsxs("div",{className:"flex items-center gap-2",children:["Active Delegates"," ",a&&`(${a.length})`,!a&&e.jsx(C,{})]}),titleRight:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-high",children:"Total Delegated Stake:"}),e.jsx("div",{className:"text-gradient",children:t?e.jsxs("div",{children:[D(new k(t.totalDelegatedStake).toARIO().valueOf())," ",s]}):e.jsx(C,{})})]}),children:a&&a.length>0&&e.jsx(Pe,{columns:c,data:l,defaultSortingState:{id:"totalStake",desc:!0},isLoading:o,noDataFoundText:"Unable to fetch delegates.",shortTable:!0})})},Es=({gateway:t})=>{const s=ge(),o=s==null?void 0:s.ownerId,a=N(i=>i.currentEpoch),l=n.useMemo(()=>t?a==null?void 0:a.prescribedObservers.find(i=>i.observerAddress===t.observerAddress):!1,[t,a]);return e.jsxs("header",{className:"flex-col text-clip rounded-xl leading-[1.4] lg:mt-6 lg:border dark:border-transparent-100-8 dark:bg-grey-1000 dark:text-grey-300",children:[e.jsxs("div",{className:"flex items-center gap-3 py-5 pl-8 text-sm lg:pl-6 lg:pr-4",children:[e.jsx("div",{className:"text-mid",children:e.jsx(B,{to:"/gateways",children:"Gateways"})}),e.jsx(hs,{className:"size-4 text-mid",strokeWidth:1.5}),t?e.jsx("div",{className:"text-low",children:t.settings.label}):e.jsx(C,{}),e.jsx("div",{className:"grow"}),e.jsx("div",{className:"items-center",children:e.jsx(Ke,{})})]}),e.jsx("div",{className:"flex flex-col items-center gap-3 rounded-xl bg-grey-900 py-5 pl-6 lg:flex-row lg:rounded-t-none",children:t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex grow flex-row items-center gap-2",children:[e.jsx(as,{className:"h-3 w-4"}),e.jsx("div",{className:"text-high",children:t.settings.label}),l&&e.jsx("div",{className:"rounded-3xl border px-2 text-sm text-gradient-primary-end",children:"Observer"})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"pr-6 text-sm text-mid",children:e.jsxs(B,{className:"flex gap-2 ",to:`/gateways/${o}/reports`,children:[e.jsx(ee,{className:"size-4 text-mid",strokeWidth:1.5}),"Reports"]})}),e.jsx("div",{className:"border-l border-grey-400 px-6 text-sm text-mid",children:e.jsxs(B,{className:"flex gap-2 ",to:`/gateways/${o}/observe`,children:[e.jsx(Ue,{className:"size-4"}),"Observe"]})})]})]}):e.jsx(C,{})})]})},Ms=({onClose:t,gateway:s})=>{const o=N(b=>b.walletAddress),{data:a}=je(o),{data:l}=be(),{data:i}=J(),c=N(b=>b.ticker),[r,f]=n.useState(0),[m,h]=n.useState(""),[x,d]=n.useState(!1),[u,j]=n.useState("-");n.useEffect(()=>{s&&f(new k(s.operatorStake).toARIO().valueOf())},[s]);const p=r+parseFloat(m),S=s?new k(s==null?void 0:s.settings.minDelegatedStake).toARIO().valueOf():10,g=r>0?1:S,A=n.useMemo(()=>({stakeAmount:Me("Stake Amount",c,1,a==null?void 0:a.ario)}),[c,a==null?void 0:a.ario]),M=n.useCallback(()=>A.stakeAmount(m)==null,[m,A]);n.useEffect(()=>{if(l&&i&&s&&M()){const b=r+parseFloat(m),{EAY:F}=qe(new k(l).toARIO(),Object.values(i).filter(G=>G.status=="joined").length,s,new X(b));j(Q(F))}else j("-")},[m,s,l,i,r,M]);const y=parseFloat(m.length===0?"0":m),L=a&&y<=a.ario?a.ario-y:-1,q=()=>{h(((a==null?void 0:a.ario)||0)+"")},R=!s||((a==null?void 0:a.ario)||0)<g,P={stakeAmount:A.stakeAmount(m),cannotStake:((a==null?void 0:a.ario)||0)<g?`Insufficient balance, at least ${g} IO required.`:void 0};return e.jsx(Z,{onClose:t,useDefaultPadding:!1,children:e.jsxs("div",{className:"w-[calc(100vw-2rem)] lg:w-[28.5rem]",children:[e.jsx("div",{className:"border-b border-b-stroke-low",children:e.jsx("div",{className:"rounded-tr-xl border-b border-red-400 bg-grey-700 py-3 text-center",children:e.jsx("span",{className:"text-gradient",children:"Stake"})})}),e.jsxs("div",{className:"flex flex-col p-8 pb-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(O,{label:"Gateway Owner:",value:Ne(s.gatewayAddress)}),e.jsx(O,{label:"Label:",value:s?s.settings.label:"-"}),e.jsx(O,{label:"Domain:",isLink:!0,value:s?s.settings.fqdn:"-"})]}),e.jsxs("div",{className:"mt-8 flex items-center",children:[e.jsx("div",{className:"text-left text-sm text-mid",children:"Amount:"}),e.jsx("div",{className:"grow"}),e.jsx("div",{className:"text-left text-xs text-low",children:a&&`Available: ${L>=0?D(+L):"-"} ${c}`})]}),e.jsxs("div",{className:"mt-3 flex h-[3.25rem] items-center overflow-hidden rounded-md border border-grey-800",children:[e.jsx("input",{className:"size-full grow  bg-grey-1000 px-6 py-3 text-sm text-mid outline-none placeholder:text-grey-400 focus:text-high",disabled:R,readOnly:R,type:"text",placeholder:`Enter amount of ${c} to stake`,value:m,onChange:b=>{const F=b.target.value;F&&isNaN(+b.target.value)||h(F)}}),s&&((m==null?void 0:m.length)>0||((a==null?void 0:a.ario)||0)<g)&&(P.cannotStake||P.stakeAmount)&&e.jsx(Le,{errorMessage:P.cannotStake??P.stakeAmount,tooltipPadding:"3"}),e.jsx(I,{className:"mr-3 h-7",onClick:R?void 0:q,buttonType:$.SECONDARY,active:!0,title:"Max",text:"Max"})]}),e.jsx("div",{className:"mt-4 flex flex-col gap-2"})]}),e.jsxs("div",{className:"flex size-full flex-col gap-2 bg-containerL0 px-8 pb-8 pt-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(O,{label:"Existing Stake:",value:`${r} ${c}`}),e.jsx(O,{label:"New Total Stake:",value:`${M()?D(p):"-"} ${c}`}),e.jsx(O,{label:"Operator EAY:",value:u,rightIcon:e.jsx(Se,{message:e.jsxs("div",{children:[e.jsx("p",{children:ke}),e.jsx(Ge,{className:"mt-4",children:He})]}),children:e.jsx(ps,{className:"size-[1.125rem]"})})})]}),e.jsx("div",{className:M()?void 0:"pointer-events-none opacity-30",children:e.jsx(I,{className:"mt-4 h-[3.25rem] w-full",onClick:()=>{d(!0)},buttonType:$.PRIMARY,title:"Review",text:"Review"})})]}),x&&s&&o&&e.jsx(fs,{amountToStake:parseFloat(m),gateway:s,onClose:()=>d(!1),onSuccess:()=>t(),ticker:c,walletAddress:o})]})})},Ls=({onClose:t,gateway:s})=>{const o=N(b=>b.walletAddress),{data:a}=je(o),l=N(b=>b.ticker),[i,c]=n.useState(0),[r,f]=n.useState(""),[m,h]=n.useState("standard"),[x,d]=n.useState(!1);n.useEffect(()=>{s&&c(new k(s.operatorStake).toARIO().valueOf())},[s]);const u=i-parseFloat(r),j=s?new k(s==null?void 0:s.settings.minDelegatedStake).toARIO().valueOf():10,p=i>0?1:j,S=m==="expedited"?.5*parseFloat(r):0,g=isNaN(parseFloat(r))?"-":+(isNaN(S)?parseFloat(r):parseFloat(r)-S).toFixed(4),A=n.useMemo(()=>({withdrawAmount:os("Withdraw Amount",l,i)}),[l,i]),M=n.useCallback(()=>A.withdrawAmount(r)==null,[r,A]),y=parseFloat(r.length===0?"0":r),L=i-1e4-y,q=()=>{f(i+"")},R=!s||i<=0,P={withdrawAmount:A.withdrawAmount(r),cannotStake:((a==null?void 0:a.ario)||0)<p?`Insufficient balance, at least ${p} IO required.`:void 0};return e.jsx(Z,{onClose:t,useDefaultPadding:!1,children:e.jsxs("div",{className:"w-[calc(100vw-2rem)] lg:w-[28.5rem]",children:[e.jsx("div",{className:"border-b border-b-stroke-low",children:e.jsx("div",{className:"rounded-tr-xl border-b border-red-400 bg-grey-700 py-3 text-center",children:e.jsx("span",{className:"text-gradient",children:"Withdraw"})})}),e.jsxs("div",{className:"flex flex-col p-8 pb-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(O,{label:"Gateway Owner:",value:Ne(s.gatewayAddress)}),e.jsx(O,{label:"Label:",value:s?s.settings.label:"-"}),e.jsx(O,{label:"Domain:",isLink:!0,value:s?s.settings.fqdn:"-"})]}),e.jsxs("div",{className:"mt-8 flex items-center",children:[e.jsx("div",{className:"text-left text-sm text-mid",children:"Amount:"}),e.jsx("div",{className:"grow"}),e.jsx("div",{className:"text-left text-xs text-low",children:`Available to Withdraw: ${L>=0?D(L):"-"} ${l}`})]}),e.jsxs("div",{className:"mt-3 flex h-[3.25rem] items-center overflow-hidden rounded-md border border-grey-800",children:[e.jsx("input",{className:"size-full grow  bg-grey-1000 px-6 py-3 text-sm text-mid outline-none placeholder:text-grey-400 focus:text-high",disabled:R,readOnly:R,type:"text",placeholder:`Enter amount of ${l} to withdraw'}`,value:r,onChange:b=>{const F=b.target.value;F&&isNaN(+b.target.value)||f(F)}}),(r==null?void 0:r.length)>0&&P.withdrawAmount&&e.jsx(Le,{errorMessage:P.withdrawAmount,tooltipPadding:"3"}),e.jsx(I,{className:"mr-3 h-7",onClick:R?void 0:q,buttonType:$.SECONDARY,active:!0,title:"Max",text:"Max"})]}),e.jsx("div",{className:"mt-4 flex flex-col gap-2",children:e.jsxs(vs,{className:"my-2 flex flex-col gap-4 text-sm",value:m,onChange:b=>h(b),children:[e.jsx(he,{value:"standard",className:`group flex w-full cursor-pointer rounded 
                  from-gradient-primary-start to-gradient-primary-end data-[checked]:bg-gradient-to-r`,children:e.jsxs("div",{className:"m-px flex size-full flex-col gap-1 rounded  bg-containerL3 px-4 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"visible size-4 group-data-[checked]:hidden"}),e.jsx(fe,{className:"hidden size-4 group-data-[checked]:block"}),e.jsx(me,{children:"Standard Withdrawal"})]}),e.jsx("p",{className:"pl-6 text-left text-xs text-mid",children:"90 day withdrawal period with no fees."})]})}),e.jsx(he,{value:"expedited",className:`group flex w-full cursor-pointer rounded 
                  from-gradient-primary-start to-gradient-primary-end data-[checked]:bg-gradient-to-r`,children:e.jsxs("div",{className:"m-px flex size-full flex-col gap-1 rounded  bg-containerL3 px-4 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"visible size-4 group-data-[checked]:hidden"}),e.jsx(fe,{className:"hidden size-4 group-data-[checked]:block"}),e.jsx(me,{children:"Expedited Withdrawal"})]}),e.jsx("p",{className:"pl-6 text-left text-xs text-mid",children:"Instant withdrawal with 50% fee."})]})})]})})]}),e.jsxs("div",{className:"flex size-full flex-col gap-2 bg-containerL0 px-8 pb-8 pt-4",children:[m=="expedited"&&e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"first:text-mid last:text-mid",label:"Fee:",value:`${isNaN(S)?"-":+S.toFixed(4)} ${l}`}),e.jsx(O,{className:"first:text-mid last:text-mid",label:"Returning Amount:",value:`${g} ${l}`})]}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsx(O,{label:"New Total Stake:",value:`${M()?D(u):"-"} ${l}`})}),e.jsx("div",{className:M()?void 0:"pointer-events-none opacity-30",children:e.jsx(I,{className:"mt-4 h-[3.25rem] w-full",onClick:()=>{d(!0)},buttonType:$.PRIMARY,title:"Review",text:"Review"})})]}),x&&s&&o&&e.jsx(gs,{amountToWithdraw:parseFloat(r),withdrawalType:m,gateway:s,onClose:()=>d(!1),onSuccess:()=>t(),ticker:l,walletAddress:o,withdrawalFee:S,returningAmount:g})]})})},Ps=({gateway:t,walletAddress:s})=>{const o=N(p=>p.ticker),{data:a}=be(),{data:l}=J(),[i,c]=n.useState(!1),[r,f]=n.useState(!1),[m,h]=n.useState(),[x,d]=n.useState(),{data:u}=Ee(),j=n.useMemo(()=>u?new k(u.operators.minStake).toARIO().valueOf():1e4,[u]);return n.useEffect(()=>{if(l&&t&&a){const p=qe(new k(a).toARIO(),Object.values(l).filter(S=>S.status=="joined").length,t,new k(t.operatorStake).toARIO());h(p.EAY)}},[t,l,a]),e.jsxs("div",{className:"w-full rounded-xl border border-transparent-100-16 text-sm",children:[e.jsxs("div",{className:"flex items-center pl-6 pr-4 pt-4",children:[e.jsx("div",{className:"grow items-center whitespace-nowrap text-mid",children:"Operator Stake"}),(t==null?void 0:t.gatewayAddress)===s&&(t==null?void 0:t.status)!="leaving"&&e.jsxs($e,{children:[e.jsx(ye,{asChild:!0,onPointerDown:p=>p.stopPropagation(),children:e.jsx("div",{className:"cursor-pointer rounded-md bg-gradient-to-b from-btn-primary-outer-gradient-start to-btn-primary-outer-gradient-end p-px",children:e.jsx("div",{className:"inline-flex size-full items-center justify-start gap-[0.6875rem] rounded-md bg-btn-primary-base bg-gradient-to-b from-btn-primary-gradient-start to-btn-primary-gradient-end px-[0.3125rem] py-[.3125rem] shadow-inner",children:e.jsx(ze,{className:"size-4"})})})}),e.jsxs(We,{className:"z-50 rounded border border-grey-500 bg-containerL0 text-sm",children:[e.jsx(z,{className:"cursor-pointer select-none px-4 py-2 outline-none  data-[highlighted]:bg-containerL3",onClick:p=>{p.stopPropagation(),c(!0)},children:"Add Stake"}),e.jsx(z,{className:"cursor-pointer select-none px-4 py-2 outline-none  data-[highlighted]:bg-containerL3",onClick:p=>{p.stopPropagation(),f(!0)},children:"Withdraw Stake"}),e.jsx(z,{className:"cursor-pointer select-none px-4 py-2 outline-none  data-[highlighted]:bg-containerL3",onClick:p=>{p.stopPropagation(),t&&d({sourceGateway:t,onClose:()=>d(void 0),maxRedelegationStake:new k(t.operatorStake-new X(j).toMARIO().valueOf()).toARIO()})},children:"Redelegate"})]})]})]}),e.jsx("div",{className:"flex items-center gap-2 p-6",children:t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grow whitespace-nowrap text-mid",children:[D(new k(t==null?void 0:t.operatorStake).toARIO().valueOf())," ",o," ",(t==null?void 0:t.status)==="leaving"&&"(Gateway Leaving Network)"]}),t.status==="joined"&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-mid",children:[m!==void 0?Q(m):e.jsx(C,{})," ","EAY","",e.jsx(Se,{message:e.jsxs("div",{children:[e.jsx("p",{children:ke}),e.jsx(Ge,{className:"mt-4",children:Qe})]}),children:e.jsx(Je,{className:"size-4"})})]})]}):e.jsx(C,{})}),i&&t&&e.jsx(Ms,{open:i,onClose:()=>c(!1),gateway:t}),r&&t&&e.jsx(Ls,{open:r,onClose:()=>f(!1),gateway:t}),x&&e.jsx(Be,{...x})]})},Fs=t=>{const s=N(a=>a.arIOReadSDK);return Y({queryKey:["gatewayVaults",t,s],queryFn:async()=>{if(!t)throw new Error("Address is not set");let a,l=[];do{const i=await s.getGatewayVaults({address:t,cursor:a,limit:100});l=l.concat(i.items),a=i.nextCursor}while(a!==void 0);return l},staleTime:1/0,enabled:!!t&&!!s})},U=Fe(),$s=({gateway:t,walletAddress:s})=>{const o=N(d=>d.ticker),{isLoading:a,data:l}=Fs(t==null?void 0:t.gatewayAddress),[i,c]=n.useState(),[r,f]=n.useState(),[m,h]=n.useState(),x=[U.accessor("balance",{id:"balance",header:"Stake Withdrawing",sortDescFirst:!0,cell:({row:d})=>`${D(new k(d.original.balance).toARIO().valueOf())} ${o}`}),U.accessor("endTimestamp",{id:"endTimestamp",header:"Date of Return",sortDescFirst:!0,cell:({row:d})=>H(new Date(d.original.endTimestamp))}),U.display({id:"actions",cell:({row:d})=>e.jsx("div",{className:"flex w-full justify-end pr-6",children:e.jsxs($e,{children:[e.jsx(ye,{asChild:!0,onPointerDown:u=>u.stopPropagation(),children:e.jsx("div",{className:"cursor-pointer rounded-md bg-gradient-to-b from-btn-primary-outer-gradient-start to-btn-primary-outer-gradient-end  p-px",children:e.jsx("div",{className:"inline-flex size-full items-center justify-start gap-[0.6875rem] rounded-md bg-btn-primary-base bg-gradient-to-b from-btn-primary-gradient-start to-btn-primary-gradient-end px-[0.3125rem] py-[.3125rem] shadow-inner",children:e.jsx(ze,{className:"size-4"})})})}),e.jsxs(We,{className:"z-50 rounded border border-grey-500 bg-containerL0 text-sm",children:[e.jsx(z,{className:"cursor-pointer select-none px-4 py-2 outline-none  data-[highlighted]:bg-containerL3",onClick:u=>{u.stopPropagation(),t&&f({gateway:t,gatewayAddress:t.gatewayAddress,vault:d.original,vaultId:d.original.vaultId})},children:"Expedite Withdrawal"}),e.jsx(z,{className:"cursor-pointer select-none px-4 py-2 outline-none  data-[highlighted]:bg-containerL3",onClick:u=>{u.stopPropagation(),t&&c({gatewayAddress:t.gatewayAddress,vaultId:d.original.vaultId})},children:"Cancel Withdrawal"}),e.jsx(z,{className:"cursor-pointer select-none  px-4 py-2 outline-none  data-[highlighted]:bg-containerL3",onClick:u=>{u.stopPropagation(),t&&h({sourceGateway:t,onClose:()=>h(void 0),maxRedelegationStake:new k(d.original.balance).toARIO(),vaultId:d.original.vaultId})},children:"Redelegate"})]})]})})})];return s==(t==null?void 0:t.gatewayAddress)&&(l!=null&&l.length)?e.jsxs(Ye,{title:"Pending Withdrawals",titleRight:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-high",children:"Total Pending:"}),e.jsx("div",{className:"text-gradient-red",children:e.jsxs("div",{children:[D(new k(l.reduce((d,u)=>d+u.balance,0)).toARIO().valueOf())," ",o]})})]}),children:[l&&l.length>0&&e.jsx(Pe,{columns:x,data:l||[],defaultSortingState:{id:"endTimestamp",desc:!1},isLoading:a,noDataFoundText:"Unable to fetch pending withdrawals.",shortTable:!0}),i&&e.jsx(js,{gatewayAddress:i.gatewayAddress,vaultId:i.vaultId,onClose:()=>c(void 0)}),r&&e.jsx(bs,{gateway:r.gateway,gatewayAddress:r.gatewayAddress,vaultId:r.vaultId,vault:r.vault,onClose:()=>f(void 0)}),m&&e.jsx(Be,{...m})]}):e.jsx(e.Fragment,{})},ys=({onClose:t})=>{const s=we(),o=N(g=>g.walletAddress),a=N(g=>g.arIOWriteableSDK),l=N(g=>g.ticker),[i,c]=n.useState(!1),[r,f]=n.useState(!1),[m,h]=n.useState(),[x,d]=n.useState(""),u=x==="LEAVE NETWORK",{data:j}=Ee(),p=n.useMemo(()=>j?new k(j.operators.minStake).toARIO().valueOf():1e4,[j]),S=async()=>{if(o&&a){c(!0);try{const{id:g}=await a.leaveNetwork(Oe);h(g),s.invalidateQueries({queryKey:["gateway",o.toString()],refetchType:"all"}),s.invalidateQueries({queryKey:["gateways"],refetchType:"all"}),f(!0)}catch(g){Ie(`${g}`)}finally{c(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{onClose:t,useDefaultPadding:!1,children:e.jsxs("div",{className:"w-[calc(100vw-2rem)] text-left lg:w-[28.4375rem]",children:[e.jsx("div",{className:"px-8  pb-4 pt-6",children:e.jsx("div",{className:"text-lg text-high",children:"Leave Network"})}),e.jsxs("div",{className:"border-y border-grey-800 p-8 text-sm text-mid",children:[e.jsx("div",{children:"This action will begin the process of removing your gateway from the network. Once confirmed, the following actions will be initiated in the next epoch:"}),e.jsxs("ul",{className:"mt-6 list-disc space-y-2 pl-8",children:[e.jsxs("li",{children:["Your gateway's primary stake (",D(p)," ",l,") will be vaulted and subject to a 90-day withdrawal period."]}),e.jsxs("li",{children:["Any additional operator stake above the minimum (",D(p)," ",l,") will be vaulted and subject to a 90-day withdrawal period."]}),e.jsxs("li",{children:["Any existing delegated stakes will be vaulted and subject to 90-day withdrawal period."," "]}),e.jsx("li",{children:"Your gateway status will change to leaving and will no longer be eligible for protocol rewards or observation duties."})]})]}),e.jsxs("div",{className:"bg-containerL0 px-8 pb-8 pt-6",children:[e.jsxs("div",{className:"mb-6 flex flex-col items-center gap-2 text-sm text-mid",children:[e.jsx("div",{children:'Please type "LEAVE NETWORK" in the text box to proceed.'}),e.jsx("input",{type:"text",onChange:g=>d(g.target.value),className:"h-7 w-full rounded-md border border-grey-700 bg-grey-1000 p-4 text-sm text-mid outline-none placeholder:text-grey-400 focus:text-high",value:x})]}),e.jsx("div",{className:"flex grow justify-center",children:e.jsx(I,{onClick:S,buttonType:$.PRIMARY,title:"Leave Network",text:e.jsx("div",{className:"py-2",children:"Leave Network"}),className:`w-full ${!u&&"pointer-events-none opacity-30"}`})})]})]})}),i&&e.jsx(Ae,{onClose:()=>c(!1),message:"Sign the following data with your wallet to proceed."}),r&&e.jsx(Re,{onClose:()=>{f(!1),t()},title:"Confirmed",bodyText:e.jsxs("div",{className:"mb-8 text-sm text-mid",children:[e.jsx("div",{children:"You have successfully left the network."}),e.jsxs("div",{className:"my-2 flex flex-col justify-center gap-2",children:[e.jsx("div",{children:"Transaction ID:"}),e.jsxs("button",{className:"flex items-center justify-center break-all",title:"View transaction on ao.link",onClick:async()=>{window.open(`https://ao.link/#/message/${m}`,"_blank")},children:[m,e.jsx(Xe,{className:"ml-1 size-3"})]})]})]})})]})},Ws=({label:t,value:s,type:o,rightComponent:a})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t border-grey-900",children:e.jsx("div",{className:" bg-grey-1000 px-6 py-3 text-xs text-low",children:t})}),e.jsx("div",{className:"flex flex-col content-center justify-center border-t border-grey-900 p-2 text-sm text-low lg:p-0",children:s===void 0?e.jsx(C,{}):typeof s=="boolean"?e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`grow ${s?"text-green-600":void 0}`,children:s?"Enabled":"Disabled"}),a]}):o=="address"||o=="tx"?e.jsx("a",{className:"text-high",href:o=="tx"?`https://viewblock.io/arweave/tx/${s}`:es((s||"").toString()),target:"_blank",rel:"noreferrer",children:s}):o=="link"?e.jsx("a",{className:"text-gradient",href:s+"",target:"_blank",rel:"noreferrer",children:s}):e.jsxs("div",{className:"flex items-center break-all",children:[e.jsx("div",{className:"grow",children:s}),a]})})]}),zs=({ownerId:t,gateway:s})=>{const o=N(p=>p.walletAddress),a=N(p=>p.ticker),l=t&&t===(o==null?void 0:o.toString()),[i,c]=n.useState(),[r,f]=n.useState(!1),[m,h]=n.useState(!1),x=s?`${s.settings.protocol}://${s.settings.fqdn}:${s.settings.port}`:void 0,d=(s==null?void 0:s.status)=="leaving",u=s!=null&&s.settings.allowDelegatedStaking?[{label:"Reward Share Ratio:",value:d?"N/A":`${s==null?void 0:s.settings.delegateRewardShareRatio}%`},{label:`Minimum Delegated Stake (${a}):`,value:d?"N/A":new k((s==null?void 0:s.settings.minDelegatedStake)||0).toARIO().valueOf()}]:[],j=[{label:"Label:",value:s==null?void 0:s.settings.label},{label:"Address:",value:x,type:"link"},{label:"Owner Wallet:",value:t,type:"address"},{label:"Observer Wallet:",value:s==null?void 0:s.observerAddress,type:"address"},{label:"Properties ID:",value:s==null?void 0:s.settings.properties,type:"tx"},{label:"Status:",value:(s==null?void 0:s.status)=="leaving"?e.jsx("div",{className:"text-[#f00]",children:"leaving"}):s==null?void 0:s.status,rightComponent:l&&(s==null?void 0:s.status)=="joined"?e.jsx(I,{className:"*:*:text-gradient-red mr-2",buttonType:$.PRIMARY,active:!0,title:"Leave Network",text:"Leave",onClick:()=>{h(!0)}}):void 0},{label:"Note:",value:s==null?void 0:s.settings.note},{label:"Reward Auto Stake:",value:d?"N/A":s==null?void 0:s.settings.autoStake},{label:"Delegated Staking:",value:d?"N/A":s==null?void 0:s.settings.allowDelegatedStaking,rightComponent:!l&&(s!=null&&s.settings.allowDelegatedStaking)&&(s==null?void 0:s.status)=="joined"?e.jsx(I,{className:"mr-2",buttonType:$.PRIMARY,active:!0,title:"Manage Stake",text:"Stake",onClick:()=>{o?c(t):f(!0)}}):void 0},...u];return e.jsxs("div",{className:"grid grid-cols-[8rem_auto] lg:grid-cols-[14.375rem_auto]",children:[j.map(({label:p,value:S,rightComponent:g},A)=>e.jsx(Ws,{label:p,value:S,rightComponent:g},A)),i&&e.jsx(Ns,{open:!!i,onClose:()=>c(void 0),ownerWallet:i}),r&&e.jsx(Ze,{onClose:()=>f(!1)}),m&&e.jsx(ys,{onClose:()=>h(!1)})]})},qs=()=>{const{data:t}=J(),[s,o]=n.useState();return n.useEffect(()=>{if(t){const a={};Object.entries(t).forEach(([l,i])=>{a[i.observerAddress]=l}),o(a)}},[t]),s},Gs=({gateway:t})=>{const{data:s}=Ce(),[o,a]=n.useState(0),[l,i]=n.useState([]),[c,r]=n.useState(0),f=qs(),m=Te();return n.useEffect(()=>{var h,x;if(s){const d=s[o];if(r((h=d==null?void 0:d.observations)!=null&&h.reports?Object.keys((x=d==null?void 0:d.observations)==null?void 0:x.reports).length:0),t){const j=((d==null?void 0:d.observations.failureSummaries[t.gatewayAddress])||[]).map(p=>({observerId:p,reportId:d==null?void 0:d.observations.reports[p]}));i(j)}else i([])}else i([])},[s,t,o]),e.jsxs("div",{className:"w-full rounded-xl border border-transparent-100-16 text-sm",children:[e.jsx("div",{className:"flex flex-col border-b border-grey-500 bg-containerL3 lg:flex-row",children:s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"grow whitespace-nowrap px-6 py-4",children:l.length==0?e.jsx("div",{className:"text-mid",children:"No Failures Reported"}):e.jsxs("div",{className:"text-mid",children:["Failed by"," ",e.jsxs("span",{className:"text-red-500",children:[l.length,"/",c]})," ","observers"]})}),e.jsx("div",{className:"mr-4 flex items-center",children:l.length<=c/2?e.jsxs("div",{className:"flex items-center text-green-500",children:[e.jsx(ks,{className:"mr-1 size-4"}),e.jsx("span",{children:o===0?"Passing":"Passed"})]}):e.jsxs("div",{className:"flex items-center text-red-500",children:[e.jsx(As,{className:"mr-1 size-4"}),e.jsx("span",{children:o===0?"Failing":"Failed"})]})})]}),e.jsx("div",{className:"grow place-items-end",children:e.jsx(Ve,{options:(s==null?void 0:s.map((h,x)=>({label:x==0?"Current Epoch":`Epoch ${h==null?void 0:h.epochIndex}`,value:x.toString()})))||[],onChange:h=>{a(Number(h.target.value))},value:o.toString()})})]}):e.jsx(C,{className:"m-4 h-4"})}),e.jsx("div",{className:"h-80 overflow-hidden overflow-y-auto scrollbar",children:l==null?void 0:l.map(h=>e.jsxs("div",{className:"flex items-center gap-1 border-t border-grey-500 py-2.5 pl-6 pr-2 text-xs text-low",children:[e.jsx(se,{className:"size-4"}),e.jsx("div",{className:"flex w-full items-center",children:f&&s?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"grow",to:`/gateways/${f[h.observerId]}`,children:h.observerId}),h.reportId&&e.jsx(I,{className:"h-fit last:p-2",active:!0,text:e.jsx(ee,{className:"size-3 text-mid",strokeWidth:1.5}),onClick:()=>{h.reportId&&m(`/gateways/${f[h.observerId]}/reports/${h.reportId}`)},title:"View Report"})]}):e.jsx(C,{className:"h-4"})})]},h.observerId))})]})},Bs=({gateway:t})=>{const{data:s}=Ce(),[o,a]=n.useState(0),[l,i]=n.useState([]),[c,r]=n.useState(),[f,m]=n.useState(),h=Te();return n.useEffect(()=>{var x;if(s){const d=s[o];if(t&&d){const u=t.observerAddress;r(d.observations.reports[u]),m(((x=d.prescribedObservers)==null?void 0:x.find(p=>p.observerAddress==u))!==void 0);const j=Object.entries(d.observations.failureSummaries).reduce((p,[S,g])=>(g.includes(u)&&p.push(S),p),[]);i(j)}else m(void 0),i([])}else m(void 0),i([])},[s,t,o]),e.jsxs("div",{className:"w-full rounded-xl border border-transparent-100-16 text-sm",children:[e.jsx("div",{className:"flex flex-col border-b border-grey-500 bg-containerL3 lg:flex-row",children:s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"grow items-center whitespace-nowrap py-4 pl-6",children:f?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-mid",children:["Reported on"," ",e.jsx("span",{className:"text-red-500",children:l.length})," ","gateways"]})}):e.jsx("div",{className:"text-low",children:"Not Selected for Observation"})}),c&&e.jsx(I,{className:"ml-3 mr-2 h-fit last:p-2",active:!0,text:e.jsx(ee,{className:"size-3 text-mid",strokeWidth:1.5}),onClick:()=>{c&&h(`/gateways/${t==null?void 0:t.gatewayAddress}/reports/${c}`)},title:"View Report"})]}),e.jsx("div",{className:"grow place-items-end",children:e.jsx(Ve,{options:(s==null?void 0:s.map((x,d)=>({label:d==0?"Current Epoch":`Epoch ${x==null?void 0:x.epochIndex}`,value:d.toString()})))||[],onChange:x=>a(Number(x.target.value)),value:o.toString()})})]}):e.jsx(C,{className:"m-4 h-4"})}),e.jsx("div",{className:"h-80 overflow-hidden overflow-y-auto scrollbar",children:l==null?void 0:l.map(x=>e.jsxs("div",{className:"flex gap-1 border-t border-grey-500 px-6 py-4 text-xs text-low",children:[e.jsx(se,{className:"size-4"}),e.jsxs("div",{children:[e.jsx(B,{to:`/gateways/${x}`,children:x})," "]})]},x))})]})},Vs=({gateway:t})=>e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[e.jsx(Gs,{gateway:t}),e.jsx(Bs,{gateway:t})]}),Ys=({url:t})=>Y({queryKey:["ario-info",t],queryFn:async()=>{if(t===void 0)throw new Error("Error: no URL provided.");const o=`${t}/ar-io/info`;return await(await De.get(o)).json()},enabled:!!t}),ve=({value:t})=>e.jsxs("div",{className:"flex gap-1",children:[e.jsx(se,{className:"size-4"}),t!==void 0?e.jsx("div",{className:"break-all text-sm text-mid",children:t}):e.jsx(C,{})]}),W=({title:t,value:s})=>e.jsxs("div",{className:"flex flex-col gap-1 border-t border-transparent-100-16 px-6 py-4",children:[e.jsx("div",{className:"text-xs text-low",children:t}),s instanceof Array?s.map((o,a)=>e.jsx(ve,{value:o},a)):e.jsx(ve,{value:s})]}),_s=({gateway:t})=>{var i;const[s,o]=n.useState(),a=t?`${t.settings.protocol}://${t.settings.fqdn}:${t.settings.port}`:void 0,l=Ys({url:a});return n.useEffect(()=>{var c;if((c=t==null?void 0:t.services)!=null&&c.bundlers){const r=t.services.bundlers.map(f=>`${f.protocol}://${f.fqdn}${f.port===443?"":`:${f.port}`}${f.path}`);o(r)}},[t]),e.jsxs("div",{className:"w-full rounded-xl border border-transparent-100-16 text-sm",children:[e.jsx("div",{className:"bg-containerL3 px-6 py-4",children:e.jsx("div",{className:"text-high",children:"Software"})}),e.jsx(W,{title:"Release Version",value:(i=l.data)==null?void 0:i.release}),s&&e.jsx(W,{title:"Bundlers",value:s.map(c=>e.jsx("a",{href:c,target:"_blank",rel:"noreferrer",children:c},c))})]})},Ks=({url:t})=>Y({queryKey:["healthcheck",t],queryFn:async()=>{if(t===void 0)throw new Error("Error: no URL provided.");const o=`${t}/ar-io/healthcheck`,l=await(await De.get(o)).json();return{uptime:l.uptime,message:l.message,date:new Date(l.date)}},enabled:!!t}),Us=t=>{const s=Math.floor(t/86400),o=Math.floor(t%86400/3600),a=Math.floor(t%3600/60),l=Math.floor(t%60);return`${s}d, ${o}h, ${a}m, ${l}s`},Hs=({gateway:t})=>{var l;const s=t?`${t.settings.protocol}://${t.settings.fqdn}:${t.settings.port}`:void 0,o=Ks({url:s}),a=n.useMemo(()=>{if(t)return t.stats.failedConsecutiveEpochs>0?-t.stats.failedConsecutiveEpochs:t.stats.passedConsecutiveEpochs},[t]);return e.jsxs("div",{className:"size-fit w-full rounded-xl border border-transparent-100-16 text-sm",children:[e.jsx("div",{className:"bg-containerL3 px-6 py-4",children:e.jsx("div",{className:"text-high",children:"Stats"})}),e.jsx(W,{title:"Join Date",value:t!=null&&t.startTimestamp?H(new Date(t==null?void 0:t.startTimestamp)):void 0}),(t==null?void 0:t.status)==="joined"?e.jsxs(e.Fragment,{children:[a&&e.jsx(W,{title:"Streak",value:e.jsx(ss,{streak:a})}),e.jsx(W,{title:"Uptime",value:o.isError?"N/A":o.isLoading?void 0:Us((l=o.data)==null?void 0:l.uptime)})]}):t&&e.jsx(W,{title:"Leave Date",value:t!=null&&t.endTimestamp?H(new Date(t==null?void 0:t.endTimestamp)):void 0})]})},it=()=>{var te,re,ae,le,ne,oe,ie,de;const t=we(),s=N(v=>v.walletAddress),o=N(v=>v.arIOWriteableSDK),a=N(v=>v.ticker),l=ge(),i=l==null?void 0:l.ownerId,c=i===(s==null?void 0:s.toString()),{data:r}=ms({ownerWalletAddress:i||void 0}),{data:f}=ts(),[m,h]=n.useState(!1),[x,d]=n.useState({}),[u,j]=n.useState({}),[p,S]=n.useState({}),[g,A]=n.useState(!1),[M,y]=n.useState(!1),{data:L}=Cs(r==null?void 0:r.observerAddress),q=L&&L.ar<.01&&L.turboCredits<.01,R=u.allowDelegatedStaking==!0,P=[["Stake",(te=r==null?void 0:r.weights)==null?void 0:te.stakeWeight],["Tenure",(re=r==null?void 0:r.weights)==null?void 0:re.tenureWeight],["Gateway Performance Ratio",((ae=r==null?void 0:r.weights)==null?void 0:ae.gatewayPerformanceRatio)??((le=r==null?void 0:r.weights)==null?void 0:le.gatewayRewardRatioWeight)],["Observer Performance Ratio",((ne=r==null?void 0:r.weights)==null?void 0:ne.observerPerformanceRatio)??((oe=r==null?void 0:r.weights)==null?void 0:oe.observerRewardRatioWeight)],["Composite",(ie=r==null?void 0:r.weights)==null?void 0:ie.compositeWeight],["Normalized",(de=r==null?void 0:r.weights)==null?void 0:de.normalizedCompositeWeight]];n.useEffect(()=>{d(v=>({...v,observerAddress:(s==null?void 0:s.toString())??""})),j(v=>({...v,observerAddress:(s==null?void 0:s.toString())??""}))},[s]),n.useEffect(()=>{if(u.allowDelegatedStaking==!1){const v={};if(u.delegateRewardShareRatio!==x.delegateRewardShareRatio&&(v.delegateRewardShareRatio=x.delegateRewardShareRatio),u.minDelegatedStake!==x.minDelegatedStake&&(v.minDelegatedStake=x.minDelegatedStake),Object.keys(v).length>0){const E={...p};Object.keys(v).forEach(w=>{delete E[w]}),S(E),j(w=>({...w,...v}))}}},[x,u,p]);const b=[{formPropertyName:"label",label:"Label:",rowType:T.TOP,validateProperty:ue("Label",1,64)},{formPropertyName:"fqdn",label:"Address:",rowType:T.BOTTOM,leftComponent:e.jsx("div",{className:"pl-6 text-xs text-low",children:"https://"}),rightComponent:e.jsx("div",{className:"pr-6 text-xs text-low",children:":443"}),validateProperty:is("Address")},{formPropertyName:"ownerId",label:"Owner Wallet:",rowType:T.SINGLE,readOnly:!0},{formPropertyName:"observerAddress",label:"Observer Wallet:",rowType:T.TOP,validateProperty:ds("Observer Wallet")},{formPropertyName:"properties",label:"Properties ID:",rowType:T.MIDDLE,validateProperty:cs("Properties ID")},{formPropertyName:"status",label:"Status:",rowType:T.SINGLE,readOnly:!0},{formPropertyName:"note",label:"Note:",rowType:T.SINGLE,validateProperty:ue("Note",1,256)},{formPropertyName:"autoStake",label:"Reward Auto Stake:",rowType:T.SINGLE},{formPropertyName:"allowDelegatedStaking",label:"Delegated Staking:",rowType:T.SINGLE},{formPropertyName:"delegateRewardShareRatio",label:"Reward Share Ratio:",rowType:T.TOP,enabled:R,placeholder:R?"Enter value 0-95":"Enable Delegated Staking to set this value.",validateProperty:xs("Reward Share Ratio",0,95)},{formPropertyName:"minDelegatedStake",label:`Minimum Delegated Stake (${a}):`,rowType:T.LAST,enabled:R,placeholder:R?`Minimum 10 ${a}`:"Enable Delegated Staking to set this value.",validateProperty:Me("Minumum Delegated Stake",a,10)}],F=()=>{if(!r)return;const v={label:r.settings.label||"",fqdn:r.settings.fqdn||"",ownerId:i||"",observerAddress:r.observerAddress||"",properties:r.settings.properties||"",status:r.status||"",note:r.settings.note||"",autoStake:r.settings.autoStake||!1,allowDelegatedStaking:(r==null?void 0:r.settings.allowDelegatedStaking)||!1,delegateRewardShareRatio:(r.settings.delegateRewardShareRatio||0)+"",minDelegatedStake:new k(r.settings.minDelegatedStake||0).toARIO().valueOf()+""};d(v),j(v),h(!0)},G=ls({initialState:x,formState:u}),_e=async()=>{if(s&&o&&xe({formRowDefs:b,formValues:u})){const v=Object.keys(u).reduce((w,_)=>u[_]!==x[_]?{...w,[_]:u[_]}:w,{}),E={allowDelegatedStaking:v.allowDelegatedStaking,delegateRewardShareRatio:u.allowDelegatedStaking&&v.delegateRewardShareRatio?parseFloat(v.delegateRewardShareRatio):void 0,fqdn:v.fqdn,label:v.label,minDelegatedStake:u.allowDelegatedStaking&&v.minDelegatedStake?new X(parseFloat(v.minDelegatedStake)).toMARIO().valueOf():void 0,note:v.note,properties:v.properties,autoStake:v.autoStake,observerAddress:v.observerAddress};A(!0);try{if(Object.values(E).some(w=>w!==void 0)){const{id:w}=await o.updateGatewaySettings(E,Oe);rs.info(`Update Gateway Settings txID: ${w}`)}t.invalidateQueries({queryKey:["gateway",s.toString()],refetchType:"all"}),t.invalidateQueries({queryKey:["gateways"],refetchType:"all"}),y(!0)}catch(w){Ie(`${w}`)}finally{A(!1)}}};return e.jsxs("div",{className:"flex h-full flex-col gap-6",children:[e.jsx("div",{className:"shrink-0",children:e.jsx(Es,{gateway:r})}),e.jsxs("div",{className:"flex flex-1 flex-col gap-6 overflow-y-auto pb-6 scrollbar",children:[c&&q&&e.jsxs("div",{className:"rounded-lg border border-warning/30 bg-warning/10 p-4 text-warning",children:[e.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[e.jsx(Os,{className:"size-5"}),"Low Balance Warning"]}),e.jsx("div",{className:"mt-1 text-sm",children:e.jsx("ul",{children:e.jsx("li",{children:"Observer AR and Turbo Credit balance is low. Please add more AR or Turbo Credits to the observer wallet."})})})]}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(Ps,{gateway:r,walletAddress:s==null?void 0:s.toString()}),e.jsx($s,{gateway:r,walletAddress:s==null?void 0:s.toString()}),e.jsx(Ds,{gateway:r}),e.jsxs("div",{className:"flex flex-col gap-6 lg:flex-row",children:[e.jsxs("div",{className:"flex min-w-72 flex-col gap-6",children:[e.jsx(Hs,{gateway:r}),(r==null?void 0:r.weights)&&(r==null?void 0:r.status)==="joined"&&e.jsxs("div",{className:"w-full rounded-xl border border-transparent-100-16 text-sm",children:[e.jsx("div",{className:"bg-containerL3 px-6 py-4",children:e.jsx("div",{className:"text-high",children:"Weights"})}),P.map(([v,E],w)=>e.jsxs("div",{className:"flex items-center gap-4 border-t border-transparent-100-16 px-6 py-4",children:[e.jsxs("div",{className:"grow text-nowrap text-xs text-low",children:[v,":"]}),e.jsx("div",{className:"text-right text-sm",children:E!==void 0?E.toFixed(3):e.jsx(C,{className:"w-10"})})]},`weights${w}`))]}),(r==null?void 0:r.status)==="joined"&&e.jsx(_s,{gateway:r})]}),e.jsxs("div",{className:"flex w-full grow flex-col gap-6",children:[e.jsxs("div",{className:"h-fit w-full overflow-hidden rounded-xl border border-transparent-100-16",children:[e.jsxs("div",{className:"flex items-center bg-containerL3 py-4 pl-6 pr-3",children:[e.jsx("div",{className:"text-sm text-high",children:"General Information"}),e.jsx("div",{className:"flex grow gap-6"}),c&&(m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex",children:e.jsx(I,{className:"h-[1.875rem]",title:"Cancel",text:"Cancel",buttonType:$.SECONDARY,onClick:()=>h(!1)})}),xe({formRowDefs:b,formValues:u})?G>0?e.jsx(I,{className:"last:text-gradient h-[1.875rem]",title:`Save ${G} changes`,text:`Save ${G} changes`,buttonType:$.SECONDARY,onClick:_e}):e.jsx(e.Fragment,{}):e.jsx("div",{className:"pl-6 text-sm text-red-600",children:"Invalid Entry"})]}):(r==null?void 0:r.status)=="joined"&&e.jsx(I,{className:"h-[1.875rem]",title:"Edit",text:"Edit",icon:e.jsx(Ss,{className:"size-3"}),active:!0,onClick:F}))]}),m?e.jsx("div",{className:" grid grid-cols-[14.375rem_auto] overflow-hidden border-t border-grey-500",children:b.map((v,E)=>e.jsx(ns,{initialState:x,formState:u,setFormState:j,errorMessages:p,setErrorMessages:S,...v},E))}):e.jsx(zs,{ownerId:i,gateway:r})]}),(f==null?void 0:f.hasEpochZeroStarted)&&e.jsx(Vs,{gateway:r})]})]}),g&&e.jsx(Ae,{onClose:()=>A(!1),message:"Sign the following data with your wallet to proceed."}),M&&e.jsx(Re,{onClose:()=>{y(!1),h(!1)},title:"Congratulations",bodyText:"You have successfully updated your gateway."})]})]})]})};export{it as default};
//# sourceMappingURL=index-DpH7ZIpC.js.map
